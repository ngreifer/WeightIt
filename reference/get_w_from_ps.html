<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute weights from propensity scores — get_w_from_ps • WeightIt</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute weights from propensity scores — get_w_from_ps"><meta name="description" content="Given a vector or matrix of propensity scores, outputs a vector
of weights that target the provided estimand."><meta property="og:description" content="Given a vector or matrix of propensity scores, outputs a vector
of weights that target the provided estimand."><meta property="og:image" content="https://ngreifer.github.io/WeightIt/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">WeightIt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/WeightIt.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/estimating-effects.html">Estimating Effects After Weighting</a></li>
    <li><a class="dropdown-item" href="../articles/installing-packages.html">Installing Supporting Packages</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ngreifer/WeightIt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute weights from propensity scores</h1>
      <small class="dont-index">Source: <a href="https://github.com/ngreifer/WeightIt/blob/master/R/get_w_from_ps.R" class="external-link"><code>R/get_w_from_ps.R</code></a></small>
      <div class="d-none name"><code>get_w_from_ps.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a vector or matrix of propensity scores, outputs a vector
of weights that target the provided estimand.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_w_from_ps</span><span class="op">(</span></span>
<span>  <span class="va">ps</span>,</span>
<span>  <span class="va">treat</span>,</span>
<span>  estimand <span class="op">=</span> <span class="st">"ATE"</span>,</span>
<span>  focal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  treated <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subclass <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stabilize <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ps">ps<a class="anchor" aria-label="anchor" href="#arg-ps"></a></dt>
<dd><p>a vector, matrix, or data frame of propensity scores. See Details.</p></dd>


<dt id="arg-treat">treat<a class="anchor" aria-label="anchor" href="#arg-treat"></a></dt>
<dd><p>a vector of treatment status for each individual. See Details.</p></dd>


<dt id="arg-estimand">estimand<a class="anchor" aria-label="anchor" href="#arg-estimand"></a></dt>
<dd><p>the desired estimand that the weights should target. Current
options include <code>"ATE"</code> (average treatment effect), <code>"ATT"</code> (average
treatment effect on the treated), <code>"ATC"</code> (average treatment effect on the
control), <code>"ATO"</code> (average treatment effect in the overlap), <code>"ATM"</code>
(average treatment effect in the matched sample), and <code>"ATOS"</code> (average
treatment effect in the optimal subset). See Details.</p></dd>


<dt id="arg-focal">focal<a class="anchor" aria-label="anchor" href="#arg-focal"></a></dt>
<dd><p>when <code>estimand</code> is <code>"ATT"</code> or <code>"ATC"</code>, which group should be
consider the (focal) "treated" or "control" group, respectively. If not
<code>NULL</code> and <code>estimand</code> is not <code>"ATT"</code> or <code>"ATC"</code>, <code>estimand</code> will
automatically be set to <code>"ATT"</code>.</p></dd>


<dt id="arg-treated">treated<a class="anchor" aria-label="anchor" href="#arg-treated"></a></dt>
<dd><p>when treatment is binary, the value of <code>treat</code> that is
considered the "treated" group (i.e., the group for which the propensity
scores are the probability of being in). If <code>NULL</code>, <code>get_w_from_ps()</code> will
attempt to figure it out on its own using some heuristics. This really only
matters when <code>treat</code> has values other than 0 and 1 and when <code>ps</code> is given
as a vector or an unnamed single-column matrix or data frame.</p></dd>


<dt id="arg-subclass">subclass<a class="anchor" aria-label="anchor" href="#arg-subclass"></a></dt>
<dd><p><code>numeric</code>; the number of subclasses to use when computing
weights using marginal mean weighting through stratification (MMWS; also known as
fine stratification). If <code>NULL</code>, standard inverse probability weights (and
their extensions) will be computed; if a number greater than 1, subclasses
will be formed and weights will be computed based on subclass membership.
<code>estimand</code> must be <code>"ATE"</code>, <code>"ATT"</code>, or <code>"ATC"</code> if <code>subclass</code> is
non-<code>NULL</code>. See Details.</p></dd>


<dt id="arg-stabilize">stabilize<a class="anchor" aria-label="anchor" href="#arg-stabilize"></a></dt>
<dd><p><code>logical</code>; whether to compute stabilized weights or not.
This simply involves multiplying each unit's weight by the proportion of
units in their treatment group. For saturated outcome models and in balance
checking, this won't make a difference; otherwise, this can improve
performance.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector of weights. When <code>subclass</code> is not <code>NULL</code>, the subclasses
are returned as the <code>"subclass"</code> attribute. When <code>estimand = "ATOS"</code>, the
chosen value of <code>alpha</code> (the smallest propensity score allowed to remain in
the sample) is returned in the <code>"alpha"</code> attribute.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>get_w_from_ps()</code> applies the formula for computing weights from
propensity scores for the desired estimand. The formula for each estimand is
below, with \(A_i\) the treatment value for unit \(i\) taking on values
\(\mathcal{A} = (1, \ldots, g)\), \(p_{a, i}\) the probability of
receiving treatment level \(a\) for unit \(i\), and \(f\) is the focal
group (the treated group for the ATT and the control group for the ATC):</p>
<p>$$
\begin{aligned}
w^{ATE}_i &amp;= 1 / p_{A_i, i} \\
w^{ATT}_i &amp;= w^{ATE}_i \times p_{f, i} \\
w^{ATO}_i &amp;= w^{ATE}_i / \sum_{a \in \mathcal{A}}{1/p_{a, i}} \\
w^{ATM}_i &amp;= w^{ATE}_i \times \min(p_{1, i}, \ldots, p_{g, i}) \\
w^{ATOS}_i &amp;= w^{ATE}_i \times \mathbb{1}\left(\alpha &lt; p_{2, i} &lt; 1 - \alpha\right)
\end{aligned}
$$</p>
<p><code>get_w_from_ps()</code> can only be used with binary and multi-category treatments.</p><div class="section">
<h3 id="supplying-the-ps-argument">Supplying the <code>ps</code> argument<a class="anchor" aria-label="anchor" href="#supplying-the-ps-argument"></a></h3>


<p>The <code>ps</code> argument can be entered in two ways:</p><ul><li><p>A numeric matrix with a row for each unit and a (named) column for each treatment level, with each cell corresponding to the probability of receiving the corresponding treatment level</p></li>
<li><p>A numeric vector with a value for each unit corresponding to the probability of being "treated" (only allowed for binary treatments)</p></li>
</ul><p>When supplied as a vector, <code>get_w_from_ps()</code> has to know which value of
<code>treat</code> corresponds to the "treated" group. For 0/1 variables, 1 will be
considered treated. For other types of variables, <code>get_w_from_ps()</code> will try
to figure it out using heuristics, but it's safer to supply an argument to
<code>treated</code>. When <code>estimand</code> is <code>"ATT"</code> or <code>"ATC"</code>, supplying a value to
<code>focal</code> is sufficient (for ATT, <code>focal</code> is the treated group, and for ATC,
<code>focal</code> is the control group).</p>
<p>When supplied as a matrix, the columns must be named with the levels of the
treatment, and it is assumed that each column corresponds to the probability
of being in that treatment group. This is the safest way to supply <code>ps</code>
unless <code>treat</code> is a 0/1 variable. When <code>estimand</code> is <code>"ATT"</code> or <code>"ATC"</code>, a
value for <code>focal</code> must be specified.</p>
</div>

<div class="section">
<h3 id="marginal-mean-weighting-through-stratification-mmws-">Marginal mean weighting through stratification (MMWS)<a class="anchor" aria-label="anchor" href="#marginal-mean-weighting-through-stratification-mmws-"></a></h3>


<p>When <code>subclass</code> is not <code>NULL</code>, MMWS weights are computed. The implementation
differs slightly from that described in Hong (2010, 2012). First, subclasses
are formed by finding the quantiles of the propensity scores in the target
group (for the ATE, all units; for the ATT or ATC, just the units in the
focal group). Any subclasses lacking members of a treatment group will be
filled in with them from neighboring subclasses so each subclass will always
have at least one member of each treatment group. A new subclass-propensity
score matrix is formed, where each unit's subclass-propensity score for each
treatment value is computed as the proportion of units with that treatment
value in the unit's subclass. For example, if a subclass had 10 treated units
and 90 control units in it, the subclass-propensity score for being treated
would be .1 and the subclass-propensity score for being control would be .9
for all units in the subclass.</p>
<p>For multi-category treatments, the propensity scores for each treatment are
stratified separately as described in Hong (2012); for binary treatments,
only one set of propensity scores are stratified and the subclass-propensity
scores for the other treatment are computed as the complement of the
propensity scores for the stratified treatment.</p>
<p>After the subclass-propensity scores have been computed, the standard
propensity score weighting formulas are used to compute the unstabilized MMWS
weights. To estimate MMWS weights equivalent to those described in Hong
(2010, 2012), <code>stabilize</code> must be set to <code>TRUE</code>, but, as with standard
propensity score weights, this is optional. Note that MMWS weights are also
known as fine stratification weights and described by Desai et al. (2017).</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<div class="section">
<h3 id="binary-treatments">Binary treatments<a class="anchor" aria-label="anchor" href="#binary-treatments"></a></h3>

<ul><li><p><code>estimand = "ATO"</code></p></li>
</ul><p>Li, F., Morgan, K. L., &amp; Zaslavsky, A. M. (2018). Balancing covariates via
propensity score weighting. Journal of the American Statistical Association,
113(521), 390–400. <a href="https://doi.org/10.1080/01621459.2016.1260466" class="external-link">doi:10.1080/01621459.2016.1260466</a></p><ul><li><p><code>estimand = "ATM"</code></p></li>
</ul><p>Li, L., &amp; Greene, T. (2013). A Weighting Analogue to Pair Matching in
Propensity Score Analysis. The International Journal of Biostatistics, 9(2).
<a href="https://doi.org/10.1515/ijb-2012-0030" class="external-link">doi:10.1515/ijb-2012-0030</a></p><ul><li><p><code>estimand = "ATOS"</code></p></li>
</ul><p>Crump, R. K., Hotz, V. J., Imbens, G. W., &amp; Mitnik, O. A. (2009). Dealing
with limited overlap in estimation of average treatment effects. Biometrika,
96(1), 187–199. <a href="https://doi.org/10.1093/biomet/asn055" class="external-link">doi:10.1093/biomet/asn055</a></p><ul><li><p>Other estimands</p></li>
</ul><p>Austin, P. C. (2011). An Introduction to Propensity Score Methods for
Reducing the Effects of Confounding in Observational Studies. Multivariate
Behavioral Research, 46(3), 399–424. <a href="https://doi.org/10.1080/00273171.2011.568786" class="external-link">doi:10.1080/00273171.2011.568786</a></p><ul><li><p>Marginal mean weighting through stratification (MMWS)</p></li>
</ul><p>Hong, G. (2010). Marginal mean weighting through stratification: Adjustment
for selection bias in multilevel data. Journal of Educational and Behavioral
Statistics, 35(5), 499–531. <a href="https://doi.org/10.3102/1076998609359785" class="external-link">doi:10.3102/1076998609359785</a></p>
<p>Desai, R. J., Rothman, K. J., Bateman, B. . T., Hernandez-Diaz, S., &amp;
Huybrechts, K. F. (2017). A Propensity-score-based Fine Stratification
Approach for Confounding Adjustment When Exposure Is Infrequent:
Epidemiology, 28(2), 249–257. <a href="https://doi.org/10.1097/EDE.0000000000000595" class="external-link">doi:10.1097/EDE.0000000000000595</a></p>
</div>

<div class="section">
<h3 id="multi-category-treatments">Multi-Category Treatments<a class="anchor" aria-label="anchor" href="#multi-category-treatments"></a></h3>

<ul><li><p><code>estimand = "ATO"</code></p></li>
</ul><p>Li, F., &amp; Li, F. (2019). Propensity score weighting for causal inference with
multiple treatments. The Annals of Applied Statistics, 13(4), 2389–2415.
<a href="https://doi.org/10.1214/19-AOAS1282" class="external-link">doi:10.1214/19-AOAS1282</a></p><ul><li><p><code>estimand = "ATM"</code></p></li>
</ul><p>Yoshida, K., Hernández-Díaz, S., Solomon, D. H., Jackson, J. W., Gagne, J.
J., Glynn, R. J., &amp; Franklin, J. M. (2017). Matching weights to
simultaneously compare three treatment groups: Comparison to three-way
matching. Epidemiology (Cambridge, Mass.), 28(3), 387–395.
<a href="https://doi.org/10.1097/EDE.0000000000000627" class="external-link">doi:10.1097/EDE.0000000000000627</a></p><ul><li><p>Other estimands</p></li>
</ul><p>McCaffrey, D. F., Griffin, B. A., Almirall, D., Slaughter, M. E., Ramchand,
R., &amp; Burgette, L. F. (2013). A Tutorial on Propensity Score Estimation for
Multiple Treatments Using Generalized Boosted Models. Statistics in Medicine,
32(19), 3388–3414. <a href="https://doi.org/10.1002/sim.5753" class="external-link">doi:10.1002/sim.5753</a></p><ul><li><p>Marginal mean weighting through stratification (MMWS)</p></li>
</ul><p>Hong, G. (2012). Marginal mean weighting through stratification: A
generalized method for evaluating multivalued and multiple treatments with
nonexperimental data. <em>Psychological Methods</em>, 17(1), 44–60.
<a href="https://doi.org/10.1037/a0024918" class="external-link">doi:10.1037/a0024918</a></p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="method_glm.html">method_glm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ngreifer.github.io/cobalt/" class="external-link">"cobalt"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span>, package <span class="op">=</span> <span class="st">"cobalt"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ps.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="va">nodegree</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>, data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>              family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="va">ps.fit</span><span class="op">$</span><span class="va">fitted.values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">w1</span> <span class="op">&lt;-</span> <span class="fu">get_w_from_ps</span><span class="op">(</span><span class="va">ps</span>, treat <span class="op">=</span> <span class="va">lalonde</span><span class="op">$</span><span class="va">treat</span>,</span></span>
<span class="r-in"><span>                    estimand <span class="op">=</span> <span class="st">"ATT"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">treatAB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">lalonde</span><span class="op">$</span><span class="va">treat</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w2</span> <span class="op">&lt;-</span> <span class="fu">get_w_from_ps</span><span class="op">(</span><span class="va">ps</span>, treat <span class="op">=</span> <span class="va">treatAB</span>,</span></span>
<span class="r-in"><span>                    estimand <span class="op">=</span> <span class="st">"ATT"</span>, focal <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">w1</span>, <span class="va">w2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">w3</span> <span class="op">&lt;-</span> <span class="fu">get_w_from_ps</span><span class="op">(</span><span class="va">ps</span>, treat <span class="op">=</span> <span class="va">treatAB</span>,</span></span>
<span class="r-in"><span>                    estimand <span class="op">=</span> <span class="st">"ATT"</span>, treated <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">w1</span>, <span class="va">w3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using MMWS</span></span></span>
<span class="r-in"><span><span class="va">w4</span> <span class="op">&lt;-</span> <span class="fu">get_w_from_ps</span><span class="op">(</span><span class="va">ps</span>, treat <span class="op">=</span> <span class="va">lalonde</span><span class="op">$</span><span class="va">treat</span>,</span></span>
<span class="r-in"><span>                    estimand <span class="op">=</span> <span class="st">"ATE"</span>, subclass <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>                    stabilize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A multi-category example using predicted probabilities</span></span></span>
<span class="r-in"><span><span class="co"># from multinomial logistic regression</span></span></span>
<span class="r-in"><span><span class="va">T3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lalonde</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">multi.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="glm_weightit.html">multinom_weightit</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">T3</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="va">nodegree</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>, data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>  vcov <span class="op">=</span> <span class="st">"none"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ps.multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">multi.fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ps.multi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           A         B         C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.3976058 0.2609169 0.3414773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.2793092 0.2324854 0.4882054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.3728859 0.2908927 0.3362214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.3711736 0.2665370 0.3622894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.3310437 0.2942148 0.3747415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.3485804 0.3109687 0.3404509</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">w5</span> <span class="op">&lt;-</span> <span class="fu">get_w_from_ps</span><span class="op">(</span><span class="va">ps.multi</span>, treat <span class="op">=</span> <span class="va">T3</span>,</span></span>
<span class="r-in"><span>                    estimand <span class="op">=</span> <span class="st">"ATE"</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

