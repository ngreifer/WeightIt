<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Empirical Balancing Calibration Weighting — method_ebcw • WeightIt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Empirical Balancing Calibration Weighting — method_ebcw" />
<meta property="og:description" content="This page explains the details of estimating weights using empirical balancing calibration weighting (EBCW) by setting method = &quot;ebcw&quot; in the call to weightit. This method can be used with binary and multinomial treatments.
In general, this method relies on estimating weights by minimizing a function of the weights subject to exact moment balancing constraints. This method relies on ATE from the ATE package.
Binary Treatments
For binary treatments, this method estimates the weights using ATE with ATT = TRUE. The following estimands are allowed: ATE, ATT, and ATC. The weights are taken from the output of the ATE fit object. When the ATE is requested, ATE is run twice, once for each treatment group.
Multinomial Treatments
For multinomial treatments, this method estimates the weights using ATE with ATT = TRUE. The following estimands are allowed: ATE and ATT. The weights are taken from the output of the ATE fit objects. When the ATE is requested, ATE is run once for each treatment group. When the ATT is requested, ATE is run once for each non-focal (i.e., control) group.
Continuous Treatments
Continuous treatments are not supported.
Longitudinal Treatments
For longitudinal treatments, the weights are the product of the weights estimated at each time point. This method is not guaranteed to yield exact balance at each time point. NOTE: the use of EBCW with longitudinal treatments has not been validated!
Sampling Weights
Sampling weights are supported through s.weights in all scenarios.
Missing Data
In the presence of missing data, the following value(s) for missing are allowed:
&quot;ind&quot; (default)First, for each variable with missingness, a new missingness indicator variable is created which takes the value 1 if the original covariate is NA and 0 otherwise. The missingness indicators are added to the model formula as main effects. The missing values in the covariates are then replaced with 0s (this value is arbitrary and does not affect estimation). The weight estimation then proceeds with this new formula and set of covariates. The covariates output in the resulting weightit object will be the original covariates with the NAs.



" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WeightIt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/WeightIt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ngreifer/WeightIt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Empirical Balancing Calibration Weighting</h1>
    
    <div class="hidden name"><code>method-ebcw.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This page explains the details of estimating weights using empirical balancing calibration weighting (EBCW) by setting <code>method = "ebcw"</code> in the call to <code><a href='weightit.html'>weightit</a></code>. This method can be used with binary and multinomial treatments.</p>
<p>In general, this method relies on estimating weights by minimizing a function of the weights subject to exact moment balancing constraints. This method relies on <code><a href='https://rdrr.io/pkg/ATE/man/ATE.html'>ATE</a></code> from the <a href='https://CRAN.R-project.org/package=ATE'><span class="pkg">ATE</span></a> package.</p>
<h3>Binary Treatments</h3>
<p>For binary treatments, this method estimates the weights using <code><a href='https://rdrr.io/pkg/ATE/man/ATE.html'>ATE</a></code> with <code>ATT = TRUE</code>. The following estimands are allowed: ATE, ATT, and ATC. The weights are taken from the output of the <code>ATE</code> fit object. When the ATE is requested, <code>ATE</code> is run twice, once for each treatment group.</p>
<h3>Multinomial Treatments</h3>
<p>For multinomial treatments, this method estimates the weights using <code><a href='https://rdrr.io/pkg/ATE/man/ATE.html'>ATE</a></code> with <code>ATT = TRUE</code>. The following estimands are allowed: ATE and ATT. The weights are taken from the output of the <code>ATE</code> fit objects. When the ATE is requested, <code>ATE</code> is run once for each treatment group. When the ATT is requested, <code>ATE</code> is run once for each non-focal (i.e., control) group.</p>
<h3>Continuous Treatments</h3>
<p>Continuous treatments are not supported.</p>
<h3>Longitudinal Treatments</h3>
<p>For longitudinal treatments, the weights are the product of the weights estimated at each time point. This method is not guaranteed to yield exact balance at each time point. NOTE: the use of EBCW with longitudinal treatments has not been validated!</p>
<h3>Sampling Weights</h3>
<p>Sampling weights are supported through <code>s.weights</code> in all scenarios.</p>
<h3>Missing Data</h3>
<p>In the presence of missing data, the following value(s) for <code>missing</code> are allowed:</p><dl>
<dt><code>"ind"</code> (default)</dt><dd><p>First, for each variable with missingness, a new missingness indicator variable is created which takes the value 1 if the original covariate is <code>NA</code> and 0 otherwise. The missingness indicators are added to the model formula as main effects. The missing values in the covariates are then replaced with 0s (this value is arbitrary and does not affect estimation). The weight estimation then proceeds with this new formula and set of covariates. The covariates output in the resulting <code>weightit</code> object will be the original covariates with the <code>NA</code>s.</p></dd>

</dl>


    </div>



    <h2 class="hasAnchor" id="additional-arguments"><a class="anchor" href="#additional-arguments"></a>Additional Arguments</h2>

    <p>All argument to <code>ATE</code> can be passed through <code>weightit</code>, with the following exceptions:</p>
<p><code>ATT</code> is ignored because the estimand is passed using <code>estimand</code>.</p>
<p>All arguments take on the defaults of those in <code>ATE</code>.</p>
    <h2 class="hasAnchor" id="additional-outputs"><a class="anchor" href="#additional-outputs"></a>Additional Outputs</h2>

    
<dl>
<dt><code>obj</code></dt><dd><p>When <code>include.obj = TRUE</code>, the empirical balancing callibration model fit. For binary treatments with <code>estimand = "ATT"</code>, the output of the call to <code><a href='https://rdrr.io/pkg/ATE/man/ATE.html'>ATE::ATE</a></code>. For binary treatments with <code>estimand = "ATE"</code> and multinomial treatments, a list of outputs of calls to <code><a href='https://rdrr.io/pkg/ATE/man/ATE.html'>ATE::ATE</a></code>.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    

<p>Chan, K. C. G., Yam, S. C. P., &amp; Zhang, Z. (2016). Globally efficient non-parametric inference of average treatment effects by empirical balancing calibration weighting. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 78(3), 673–700. doi: <a href='https://doi.org/10.1111/rssb.12129'>10.1111/rssb.12129</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='weightit.html'>weightit</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='st'><a href='https://github.com/ngreifer/cobalt'>"cobalt"</a></span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"lalonde"</span>, package = <span class='st'>"cobalt"</span>)

<span class='co'>#Balancing covariates between treatment groups (binary)</span>
(<span class='kw'>W1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='weightit.html'>weightit</a></span>(<span class='kw'>treat</span> <span class='op'>~</span> <span class='kw'>age</span> <span class='op'>+</span> <span class='kw'>educ</span> <span class='op'>+</span> <span class='kw'>married</span> <span class='op'>+</span>
                  <span class='kw'>nodegree</span> <span class='op'>+</span> <span class='kw'>re74</span>, data = <span class='kw'>lalonde</span>,
                method = <span class='st'>"ebcw"</span>, estimand = <span class='st'>"ATT"</span>))</div><div class='output co'>#&gt; A <span style='font-style: italic;'>weightit</span><span> object
#&gt;  - method: "ebcw" (empirical balancing calibration weighting)
#&gt;  - number of obs.: 614
#&gt;  - sampling weights: none
#&gt;  - treatment: 2-category
#&gt;  - estimand: ATT (focal: 1)
#&gt;  - covariates: age, educ, married, nodegree, re74</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>W1</span>)</div><div class='output co'>#&gt;                  </span><span style='text-decoration: underline;'>Summary of weights</span><span>
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Weight ranges</span><span>:
#&gt; 
#&gt;            Min                                    Max
#&gt; treated 1.0000                              || 1.0000
#&gt; control 0.0001   ||                            0.0122
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Units with 5 greatest weights by group</span><span>:
#&gt;                                           
#&gt;               1     2      3      4      5
#&gt;  treated      1     1      1      1      1
#&gt;             595   589    409    296    269
#&gt;  control 0.0079 0.008 0.0085 0.0094 0.0122
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Weight statistics</span><span>:
#&gt; 
#&gt;         Coef of Var   MAD Entropy # Zeros
#&gt; treated       0.000 0.000   0.000       0
#&gt; control       0.839 0.707  -5.721       0
#&gt; overall       1.512 1.387  -0.031       0
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Effective Sample Sizes</span><span>:
#&gt; 
#&gt;            Control Treated
#&gt; Unweighted  429.       185
#&gt; Weighted    252.12     185</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/cobalt/man/bal.tab.html'>bal.tab</a></span>(<span class='kw'>W1</span>)</div><div class='output co'>#&gt; </span><span style='text-decoration: underline;'>Call</span><span>
#&gt;  weightit(formula = treat ~ age + educ + married + nodegree + re74, data = lalonde, method = "ebcw", estimand = "ATT")
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Balance Measures</span><span>
#&gt;             Type Diff.Adj
#&gt; age      Contin.       -0
#&gt; educ     Contin.        0
#&gt; married   Binary       -0
#&gt; nodegree  Binary        0
#&gt; re74     Contin.       -0
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Effective sample sizes</span><span>
#&gt;            Control Treated
#&gt; Unadjusted 429.000     185
#&gt; Adjusted   252.121     185</div><div class='input'>
<span class='co'>#Balancing covariates with respect to race (multinomial)</span>
(<span class='kw'>W2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='weightit.html'>weightit</a></span>(<span class='kw'>race</span> <span class='op'>~</span> <span class='kw'>age</span> <span class='op'>+</span> <span class='kw'>educ</span> <span class='op'>+</span> <span class='kw'>married</span> <span class='op'>+</span>
                  <span class='kw'>nodegree</span> <span class='op'>+</span> <span class='kw'>re74</span>, data = <span class='kw'>lalonde</span>,
                method = <span class='st'>"ebcw"</span>, estimand = <span class='st'>"ATE"</span>))</div><div class='output co'>#&gt; A </span><span style='font-style: italic;'>weightit</span><span> object
#&gt;  - method: "ebcw" (empirical balancing calibration weighting)
#&gt;  - number of obs.: 614
#&gt;  - sampling weights: none
#&gt;  - treatment: 3-category (black, hispan, white)
#&gt;  - estimand: ATE
#&gt;  - covariates: age, educ, married, nodegree, re74</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>W2</span>)</div><div class='output co'>#&gt;                  </span><span style='text-decoration: underline;'>Summary of weights</span><span>
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Weight ranges</span><span>:
#&gt; 
#&gt;           Min                                  Max
#&gt; black  0.0023 |-----------|                 0.0220
#&gt; hispan 0.0020 |---------------------------| 0.0463
#&gt; white  0.0013 |-|                           0.0064
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Units with 5 greatest weights by group</span><span>:
#&gt;                                           
#&gt;            485    244    226    182    181
#&gt;   black 0.0104 0.0105 0.0115 0.0146  0.022
#&gt;            564    392    371    345    269
#&gt;  hispan 0.0284 0.0351 0.0366 0.0376 0.0463
#&gt;            599    589    531    457     68
#&gt;   white 0.0057 0.0058 0.0058 0.0059 0.0064
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Weight statistics</span><span>:
#&gt; 
#&gt;         Coef of Var   MAD Entropy # Zeros
#&gt; black         0.590 0.413  -5.362       0
#&gt; hispan        0.609 0.440  -4.113       0
#&gt; white         0.371 0.306  -5.633       0
#&gt; overall       0.966 0.559  -5.036       0
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Effective Sample Sizes</span><span>:
#&gt; 
#&gt;             black hispan  white
#&gt; Unweighted 243.    72.   299.  
#&gt; Weighted   180.47  52.71 262.93</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/cobalt/man/bal.tab.html'>bal.tab</a></span>(<span class='kw'>W2</span>)</div><div class='output co'>#&gt; </span><span style='text-decoration: underline;'>Call</span><span>
#&gt;  weightit(formula = race ~ age + educ + married + nodegree + re74, data = lalonde, method = "ebcw", estimand = "ATE")
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Balance summary across all treatment pairs</span><span>
#&gt;             Type Max.Diff.Adj
#&gt; age      Contin.            0
#&gt; educ     Contin.            0
#&gt; married   Binary            0
#&gt; nodegree  Binary            0
#&gt; re74     Contin.            0
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Effective sample sizes</span><span>
#&gt;              black hispan   white
#&gt; Unadjusted 243.000 72.000 299.000
#&gt; Adjusted   180.469 52.706 262.929</div><div class='input'></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


