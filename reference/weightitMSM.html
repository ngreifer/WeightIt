<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate Balancing Weights for Longitudinal Treatments — weightitMSM • WeightIt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Balancing Weights for Longitudinal Treatments — weightitMSM"><meta name="description" content="weightitMSM() allows for the easy generation of balancing weights for
marginal structural models for time-varying treatments using a variety of
available methods for binary, continuous, and multi-category treatments. Many
of these methods exist in other packages, which weightit() calls; these
packages must be installed to use the desired method."><meta property="og:description" content="weightitMSM() allows for the easy generation of balancing weights for
marginal structural models for time-varying treatments using a variety of
available methods for binary, continuous, and multi-category treatments. Many
of these methods exist in other packages, which weightit() calls; these
packages must be installed to use the desired method."><meta property="og:image" content="https://ngreifer.github.io/WeightIt/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">WeightIt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/WeightIt.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/estimating-effects.html">Estimating Effects After Weighting</a></li>
    <li><a class="dropdown-item" href="../articles/installing-packages.html">Installing Supporting Packages</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ngreifer/WeightIt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate Balancing Weights for Longitudinal Treatments</h1>
      <small class="dont-index">Source: <a href="https://github.com/ngreifer/WeightIt/blob/master/R/weightitMSM.R" class="external-link"><code>R/weightitMSM.R</code></a></small>
      <div class="d-none name"><code>weightitMSM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>weightitMSM()</code> allows for the easy generation of balancing weights for
marginal structural models for time-varying treatments using a variety of
available methods for binary, continuous, and multi-category treatments. Many
of these methods exist in other packages, which <code><a href="weightit.html">weightit()</a></code> calls; these
packages must be installed to use the desired method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">weightitMSM</span><span class="op">(</span></span>
<span>  <span class="va">formula.list</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"glm"</span>,</span>
<span>  stabilize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num.formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  moments <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  int <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  missing <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include.obj <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keep.mparts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">is.MSM.method</span>,</span>
<span>  weightit.force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula-list">formula.list<a class="anchor" aria-label="anchor" href="#arg-formula-list"></a></dt>
<dd><p>a list of formulas corresponding to each time point with
the time-specific treatment variable on the left hand side and pre-treatment
covariates to be balanced on the right hand side. The formulas must be in
temporal order, and must contain all covariates to be balanced at that time
point (i.e., treatments and covariates featured in early formulas should
appear in later ones). Interactions and functions of covariates are allowed.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data set in the form of a data frame that contains
the variables in the formulas in <code>formula.list</code>. This must be a wide
data set with exactly one row per unit.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>a string of length 1 containing the name of the method that
will be used to estimate weights. See <code><a href="weightit.html">weightit()</a></code> for allowable options.
The default is <code>"glm"</code>, which estimates the weights using generalized
linear models.</p></dd>


<dt id="arg-stabilize">stabilize<a class="anchor" aria-label="anchor" href="#arg-stabilize"></a></dt>
<dd><p><code>logical</code>; whether or not to stabilize the weights.
Stabilizing the weights involves fitting a model predicting treatment at
each time point from treatment status at prior time points. If <code>TRUE</code>,
a fully saturated model will be fit (i.e., all interactions between all
treatments up to each time point), essentially using the observed treatment
probabilities in the numerator (for binary and multi-category treatments). This
may yield an error if some combinations are not observed. Default is
<code>FALSE</code>. To manually specify stabilization model formulas, e.g., to
specify non-saturated models, use <code>num.formula</code>. With many time points,
saturated models may be time-consuming or impossible to fit.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>a string containing the name of the variable in <code>data</code> for
which weighting is to be done within categories or a one-sided formula with
the stratifying variable on the right-hand side. For example, if <code>by = "gender"</code> or <code>by = ~gender</code>, a separate propensity score model or optimization will occur within each level of the variable <code>"gender"</code>. Only one
<code>by</code> variable is allowed; to stratify by multiply variables
simultaneously, create a new variable that is a full cross of those
variables using <code><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction()</a></code>.</p></dd>


<dt id="arg-s-weights">s.weights<a class="anchor" aria-label="anchor" href="#arg-s-weights"></a></dt>
<dd><p>A vector of sampling weights or the name of a variable in
<code>data</code> that contains sampling weights. These can also be matching
weights if weighting is to be used on matched data. See the individual pages
for each method for information on whether sampling weights can be supplied.</p></dd>


<dt id="arg-num-formula">num.formula<a class="anchor" aria-label="anchor" href="#arg-num-formula"></a></dt>
<dd><p>optional; a one-sided formula with the stabilization
factors (other than the previous treatments) on the right hand side, which
adds, for each time point, the stabilization factors to a model saturated
with previous treatments. See Cole &amp; Hernán (2008) for a discussion of how
to specify this model; including stabilization factors can change the
estimand without proper adjustment, and should be done with caution. Can
also be a list of one-sided formulas, one for each time point. Unless you
know what you are doing, we recommend setting <code>stabilize = TRUE</code> and
ignoring <code>num.formula</code>.</p></dd>


<dt id="arg-moments">moments<a class="anchor" aria-label="anchor" href="#arg-moments"></a></dt>
<dd><p><code>numeric</code>; for some methods, the greatest power of each
covariate to be balanced. For example, if <code>moments = 3</code>, for each
non-categorical covariate, the covariate, its square, and its cube will be
balanced. This argument is ignored for other methods; to balance powers of
the covariates, appropriate functions must be entered in <code>formula</code>. See
the individual pages for each method for information on whether they accept
<code>moments</code>.</p></dd>


<dt id="arg-int">int<a class="anchor" aria-label="anchor" href="#arg-int"></a></dt>
<dd><p><code>logical</code>; for some methods, whether first-order
interactions of the covariates are to be balanced. This argument is ignored
for other methods; to balance interactions between the variables,
appropriate functions must be entered in <code>formula</code>. See the individual
pages for each method for information on whether they accept <code>int</code>.</p></dd>


<dt id="arg-missing">missing<a class="anchor" aria-label="anchor" href="#arg-missing"></a></dt>
<dd><p><code>character</code>; how missing data should be handled. The
options and defaults depend on the <code>method</code> used. Ignored if no missing
data is present. It should be noted that multiple imputation outperforms all
available missingness methods available in <code><a href="weightit.html">weightit()</a></code> and should
probably be used instead. Consider the <a href="https://CRAN.R-project.org/package=MatchThem" class="external-link"><span class="pkg">MatchThem</span></a>
package for the use of <code><a href="weightit.html">weightit()</a></code> with multiply imputed data.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical</code>; whether to print additional information
output by the fitting function.</p></dd>


<dt id="arg-include-obj">include.obj<a class="anchor" aria-label="anchor" href="#arg-include-obj"></a></dt>
<dd><p>whether to include in the output a list of the fit
objects created in the process of estimating the weights at each time point.
For example, with <code>method = "glm"</code>, a list of the <code>glm</code> objects
containing the propensity score models at each time point will be included.
See the help pages for each method for information on what object will be
included if <code>TRUE</code>.</p></dd>


<dt id="arg-keep-mparts">keep.mparts<a class="anchor" aria-label="anchor" href="#arg-keep-mparts"></a></dt>
<dd><p><code>logical</code>; whether to include in the output components necessary to estimate standard errors that account for estimation of the weights in <code><a href="glm_weightit.html">glm_weightit()</a></code>. Default is <code>TRUE</code> if such parts are present. See the individual pages for each method for whether these components are produced. Set to <code>FALSE</code> to keep the output object smaller, e.g., if standard errors will not be computed using <code><a href="glm_weightit.html">glm_weightit()</a></code>.</p></dd>


<dt id="arg-is-msm-method">is.MSM.method<a class="anchor" aria-label="anchor" href="#arg-is-msm-method"></a></dt>
<dd><p>whether the method estimates weights for multiple time
points all at once (<code>TRUE</code>) or by estimating weights at each time point
and then multiplying them together (<code>FALSE</code>). This is only relevant for user-specified functions.</p></dd>


<dt id="arg-weightit-force">weightit.force<a class="anchor" aria-label="anchor" href="#arg-weightit-force"></a></dt>
<dd><p>several methods are not valid for estimating weights
with longitudinal treatments, and will produce an error message if
attempted. Set to <code>TRUE</code> to bypass this error message.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments for functions called by <code><a href="weightit.html">weightit()</a></code> that
control aspects of fitting that are not covered by the above arguments. See
Details at <code><a href="weightit.html">weightit()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>weightitMSM</code> object with the following elements:</p>
<dl><dt>weights</dt>
<dd><p>The estimated weights, one for each unit.</p></dd>

<dt>treat.list</dt>
<dd><p>A list of the values of the time-varying treatment variables.</p></dd>

<dt>covs.list</dt>
<dd><p>A list of the covariates used in the fitting at each time point. Only includes the raw covariates, which may have been altered in the fitting process.</p></dd>

<dt>data</dt>
<dd><p>The data.frame originally entered to <code>weightitMSM()</code>.</p></dd>

<dt>estimand</dt>
<dd><p>"ATE", currently the only estimand for MSMs with binary or multi-category treatments.</p></dd>

<dt>method</dt>
<dd><p>The weight estimation method specified.</p></dd>

<dt>ps.list</dt>
<dd><p>A list of the estimated propensity scores (if any) at each time point.</p></dd>

<dt>s.weights</dt>
<dd><p>The provided sampling weights.</p></dd>

<dt>by</dt>
<dd><p>A data.frame containing the <code>by</code> variable when specified.</p></dd>

<dt>stabilization</dt>
<dd><p>The stabilization factors, if any.</p></dd>


</dl><p>When <code>keep.mparts</code> is <code>TRUE</code> (the default) and the chosen method is compatible with M-estimation, the components related to M-estimation for use in <code><a href="glm_weightit.html">glm_weightit()</a></code> are stored in the <code>"Mparts.list"</code> attribute. When <code>by</code> is specified, <code>keep.mparts</code> is set to <code>FALSE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Currently only "wide" data sets, where each row corresponds to a unit's
entire variable history, are supported. You can use <code><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape()</a></code> or other
functions to transform your data into this format; see example below.</p>
<p>In general, <code>weightitMSM()</code> works by separating the estimation of
weights into separate procedures for each time period based on the formulas
provided. For each formula, <code>weightitMSM()</code> simply calls
<code><a href="weightit.html">weightit()</a></code> to that formula, collects the weights for each time
period, and multiplies them together to arrive at longitudinal balancing
weights.</p>
<p>Each formula should contain all the covariates to be balanced on. For
example, the formula corresponding to the second time period should contain
all the baseline covariates, the treatment variable at the first time
period, and the time-varying covariates that took on values after the first
treatment and before the second. Currently, only wide data sets are
supported, where each unit is represented by exactly one row that contains
the covariate and treatment history encoded in separate variables.</p>
<p>The <code>"cbps"</code> method, which calls <code>CBPS()</code> in <span class="pkg">CBPS</span>, will
yield different results from <code>CBMSM()</code> in <span class="pkg">CBPS</span> because
<code>CBMSM()</code> takes a different approach to generating weights than simply
estimating several time-specific models.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cole, S. R., &amp; Hernán, M. A. (2008). Constructing Inverse
Probability Weights for Marginal Structural Models. American Journal of
Epidemiology, 168(6), 656–664. <a href="https://doi.org/10.1093/aje/kwn164" class="external-link">doi:10.1093/aje/kwn164</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="weightit.html">weightit()</a></code> for information on the allowable methods</p>
<p><code><a href="summary.weightit.html">summary.weightitMSM()</a></code> for summarizing the weights</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ngreifer.github.io/cobalt/" class="external-link">"cobalt"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"msmdata"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">W1</span> <span class="op">&lt;-</span> <span class="fu">weightitMSM</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">A_1</span> <span class="op">~</span> <span class="va">X1_0</span> <span class="op">+</span> <span class="va">X2_0</span>,</span></span>
<span class="r-in"><span>                        <span class="va">A_2</span> <span class="op">~</span> <span class="va">X1_1</span> <span class="op">+</span> <span class="va">X2_1</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                          <span class="va">A_1</span> <span class="op">+</span> <span class="va">X1_0</span> <span class="op">+</span> <span class="va">X2_0</span>,</span></span>
<span class="r-in"><span>                        <span class="va">A_3</span> <span class="op">~</span> <span class="va">X1_2</span> <span class="op">+</span> <span class="va">X2_2</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                          <span class="va">A_2</span> <span class="op">+</span> <span class="va">X1_1</span> <span class="op">+</span> <span class="va">X2_1</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                          <span class="va">A_1</span> <span class="op">+</span> <span class="va">X1_0</span> <span class="op">+</span> <span class="va">X2_0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">msmdata</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A <span style="font-style: italic;">weightitMSM</span> object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: "glm" (propensity score weighting with GLM)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 7500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - sampling weights: none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of time points: 3 (A_1, A_2, A_3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - treatment:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     + time 1: 2-category</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     + time 2: 2-category</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     + time 3: 2-category</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     + baseline: X1_0, X2_0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     + after time 1: X1_1, X2_1, A_1, X1_0, X2_0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     + after time 2: X1_2, X2_2, A_2, X1_1, X2_1, A_1, X1_0, X2_0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">W1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="text-decoration: line-through;">                       </span><span style="font-style: italic;"> Time 1 </span><span style="text-decoration: line-through;">                       </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   <span style="text-decoration: underline;">Summary of weights</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Weight ranges</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Min                                    Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treated 1.0791 |---------------------------| 403.4833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> control 1.2761 |-------------------|         284.7636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Units with the 5 most extreme weights by group</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              5488     3440     3593     1286     5685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treated  166.992 170.5549 196.4136 213.1934 403.4833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              2594     2932     5226     1875     2533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  control 155.6248  168.964 172.4195 245.8822 284.7636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Weight statistics</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Coef of Var   MAD Entropy # Zeros</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treated       1.914 0.816   0.649       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> control       1.706 0.862   0.670       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Effective Sample Sizes</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unweighted 3306.    4194. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Weighted    845.79   899.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="text-decoration: line-through;">                       </span><span style="font-style: italic;"> Time 2 </span><span style="text-decoration: line-through;">                       </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   <span style="text-decoration: underline;">Summary of weights</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Weight ranges</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Min                                    Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treated 1.0791 |---------------------------| 403.4833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> control 1.2761 |----------------|            245.8822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Units with the 5 most extreme weights by group</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              2932     3440     3593     2533     5685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treated  168.964 170.5549 196.4136 284.7636 403.4833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              2594     5488     5226     1286     1875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  control 155.6248  166.992 172.4195 213.1934 245.8822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Weight statistics</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Coef of Var   MAD Entropy # Zeros</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treated       1.892 0.819   0.652       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> control       1.748 0.869   0.686       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Effective Sample Sizes</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unweighted 3701.   3799.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Weighted    912.87  829.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="text-decoration: line-through;">                       </span><span style="font-style: italic;"> Time 3 </span><span style="text-decoration: line-through;">                       </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   <span style="text-decoration: underline;">Summary of weights</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Weight ranges</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Min                                    Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treated 1.0791 |---------------------------| 403.4833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> control 1.2761 |---------|                   148.1547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Units with the 5 most extreme weights by group</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              3593     1286     1875     2533     5685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treated 196.4136 213.1934 245.8822 284.7636 403.4833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              6862      168     3729     6158     3774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  control  88.0721  97.8273  104.623 121.8451 148.1547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Weight statistics</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Coef of Var   MAD Entropy # Zeros</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treated       1.832 0.975   0.785       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> control       1.254 0.683   0.412       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - <span style="font-style: italic;">Effective Sample Sizes</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unweighted 4886.   2614.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Weighted   1900.26  600.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab</a></span><span class="op">(</span><span class="va">W1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="text-decoration: underline;">Balance summary across all time points</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Times    Type Max.Diff.Adj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1_0 1, 2, 3 Contin.       0.0342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2_0 1, 2, 3  Binary       0.0299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1_1    2, 3 Contin.       0.0657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2_1    2, 3  Binary       0.0299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A_1     2, 3  Binary       0.0262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1_2       3 Contin.       0.0643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2_2       3  Binary       0.0096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A_2        3  Binary       0.0054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="text-decoration: underline;">Effective sample sizes</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - <span style="font-style: italic;">Time 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unadjusted 3306.    4194. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjusted    845.79   899.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - <span style="font-style: italic;">Time 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unadjusted 3701.   3799.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjusted    912.87  829.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - <span style="font-style: italic;">Time 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unadjusted 4886.   2614.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjusted   1900.26  600.12</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Using stabilization factors</span></span></span>
<span class="r-in"><span><span class="va">W2</span> <span class="op">&lt;-</span> <span class="fu">weightitMSM</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">A_1</span> <span class="op">~</span> <span class="va">X1_0</span> <span class="op">+</span> <span class="va">X2_0</span>,</span></span>
<span class="r-in"><span>                        <span class="va">A_2</span> <span class="op">~</span> <span class="va">X1_1</span> <span class="op">+</span> <span class="va">X2_1</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                          <span class="va">A_1</span> <span class="op">+</span> <span class="va">X1_0</span> <span class="op">+</span> <span class="va">X2_0</span>,</span></span>
<span class="r-in"><span>                        <span class="va">A_3</span> <span class="op">~</span> <span class="va">X1_2</span> <span class="op">+</span> <span class="va">X2_2</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                          <span class="va">A_2</span> <span class="op">+</span> <span class="va">X1_1</span> <span class="op">+</span> <span class="va">X2_1</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                          <span class="va">A_1</span> <span class="op">+</span> <span class="va">X1_0</span> <span class="op">+</span> <span class="va">X2_0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">msmdata</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"glm"</span>,</span></span>
<span class="r-in"><span>                   stabilize <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                   num.formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">~</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                      <span class="op">~</span> <span class="va">A_1</span>,</span></span>
<span class="r-in"><span>                                      <span class="op">~</span> <span class="va">A_1</span> <span class="op">+</span> <span class="va">A_2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Same as above but with fully saturated stabilization factors</span></span></span>
<span class="r-in"><span><span class="co">#(i.e., making the last entry in 'num.formula' A_1*A_2)</span></span></span>
<span class="r-in"><span><span class="va">W3</span> <span class="op">&lt;-</span> <span class="fu">weightitMSM</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">A_1</span> <span class="op">~</span> <span class="va">X1_0</span> <span class="op">+</span> <span class="va">X2_0</span>,</span></span>
<span class="r-in"><span>                        <span class="va">A_2</span> <span class="op">~</span> <span class="va">X1_1</span> <span class="op">+</span> <span class="va">X2_1</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                          <span class="va">A_1</span> <span class="op">+</span> <span class="va">X1_0</span> <span class="op">+</span> <span class="va">X2_0</span>,</span></span>
<span class="r-in"><span>                        <span class="va">A_3</span> <span class="op">~</span> <span class="va">X1_2</span> <span class="op">+</span> <span class="va">X2_2</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                          <span class="va">A_2</span> <span class="op">+</span> <span class="va">X1_1</span> <span class="op">+</span> <span class="va">X2_1</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                          <span class="va">A_1</span> <span class="op">+</span> <span class="va">X1_0</span> <span class="op">+</span> <span class="va">X2_0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">msmdata</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"glm"</span>,</span></span>
<span class="r-in"><span>                   stabilize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

