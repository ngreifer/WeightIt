<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Propensity Score Weighting Using Generalized Linear Models — method_ps • WeightIt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Propensity Score Weighting Using Generalized Linear Models — method_ps" />
<meta property="og:description" content="This page explains the details of estimating weights from generalized linear model-based propensity scores by setting method = &quot;ps&quot; in the call to weightit or weightitMSM. This method can be used with binary, multinomial, and continuous treatments.
In general, this method relies on estimating propensity scores with a parametric generalized linear model and then converting those propensity scores into weights using a formula that depends on the desired estimand. For binary and multinomial treatments, a binomial or multinomial regression model is used to estimate the propensity scores as the predicted probability of being in each treatment given the covariates. For ordinal treatments, an ordinal regression model is used to estimate generalized propensity scores. For continuous treatments, a generalized linear model is used to estimate generalized propensity scores as the conditional density of treatment given the covariates.
Binary Treatments
For binary treatments, this method estimates the propensity scores using glm. An additional argument is link, which uses the same options as link in family. The default link is &quot;logit&quot;, but others, including &quot;probit&quot;, are allowed. The following estimands are allowed: ATE, ATT, ATC, ATO, ATM, and ATOS. Weights can also be computed using marginal mean weighting through stratification for the ATE, ATT, and ATC. See get_w_from_ps for details.
Multinomial Treatments
For multinomial treatments, the propensity scores are estimated using multinomial regression from one of a few functions depending on the requested link: for logit (&quot;logit&quot;) and probit (&quot;probit&quot;) links, mlogit from the mlogit package is used; for the Bayesian probit (&quot;bayes.probit&quot;) link, mnp from the MNP package is used; and for the biased-reduced multinomial logistic regression (&quot;br.logit&quot;), brmultinom from the brglm2 package is used. If the treatment variable is an ordered factor, polr from the MASS package is used to fit ordinal regression. Any of the methods allowed in the method argument of polr can be supplied to link. The following estimands are allowed: ATE, ATT, ATC, ATO, and ATM. The weights for each estimand are computed using the standard formulas or those mentioned above. Weights can also be computed using marginal mean weighting through stratification for the ATE, ATT, and ATC. See get_w_from_ps for details.
Continuous Treatments
For continuous treatments, the generalized propensity score is estimated using linear regression. The conditional density can be specified as normal or another distribution. In addition, kernel density estimation can be used instead of assuming a specific density for the numerator and denominator of the generalized propensity score by setting use.kernel = TRUE. Other arguments to density can be specified to refine the density estimation parameters. plot = TRUE can be specified to plot the density for the numerator and denominator, which can be helpful in diagnosing extreme weights.
Longitudinal Treatments
For longitudinal treatments, the weights are the product of the weights estimated at each time point.
Sampling Weights
Sampling weights are supported through s.weights in all scenarios except for multinomial treatments with link = &quot;bayes.probit&quot;. Warning messages may appear otherwise about non-integer successes, and these can be ignored.
Missing Data
In the presence of missing data, the following value(s) for missing are allowed:
&quot;ind&quot; (default)First, for each variable with missingness, a new missingness indicator variable is created which takes the value 1 if the original covariate is NA and 0 otherwise. The missingness indicators are added to the model formula as main effects. The missing values in the covariates are then replaced with 0s (this value is arbitrary and does not affect estimation). The weight estimation then proceeds with this new formula and set of covariates. The covariates output in the resulting weightit object will be the original covariates with the NAs.
&quot;saem&quot;For binary treatments with link = &quot;logit&quot; or continuous treatments, a stochastic approximation version of the EM algorithm (SAEM) is used via the misaem package. No additional covariates are created. See Jiang et al. (2019) for information on this method. In some cases, this is a suitable alternative to multiple imputation.



" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WeightIt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/WeightIt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ngreifer/WeightIt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Propensity Score Weighting Using Generalized Linear Models</h1>
    
    <div class="hidden name"><code>method-ps.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This page explains the details of estimating weights from generalized linear model-based propensity scores by setting <code>method = "ps"</code> in the call to <code><a href='weightit.html'>weightit</a></code> or <code><a href='weightitMSM.html'>weightitMSM</a></code>. This method can be used with binary, multinomial, and continuous treatments.</p>
<p>In general, this method relies on estimating propensity scores with a parametric generalized linear model and then converting those propensity scores into weights using a formula that depends on the desired estimand. For binary and multinomial treatments, a binomial or multinomial regression model is used to estimate the propensity scores as the predicted probability of being in each treatment given the covariates. For ordinal treatments, an ordinal regression model is used to estimate generalized propensity scores. For continuous treatments, a generalized linear model is used to estimate generalized propensity scores as the conditional density of treatment given the covariates.</p>
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Binary Treatments</h3>
<p>For binary treatments, this method estimates the propensity scores using <code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code>. An additional argument is <code>link</code>, which uses the same options as <code>link</code> in <code><a href='https://rdrr.io/r/stats/family.html'>family</a></code>. The default link is "logit", but others, including "probit", are allowed. The following estimands are allowed: ATE, ATT, ATC, ATO, ATM, and ATOS. Weights can also be computed using marginal mean weighting through stratification for the ATE, ATT, and ATC. See <code><a href='get_w_from_ps.html'>get_w_from_ps</a></code> for details.</p>
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Multinomial Treatments</h3>
<p>For multinomial treatments, the propensity scores are estimated using multinomial regression from one of a few functions depending on the requested link: for logit (<code>"logit"</code>) and probit (<code>"probit"</code>) links, <code><a href='https://rdrr.io/pkg/mlogit/man/mlogit.html'>mlogit</a></code> from the <span class="pkg">mlogit</span> package is used; for the Bayesian probit (<code>"bayes.probit"</code>) link, <code><a href='https://rdrr.io/pkg/MNP/man/mnp.html'>mnp</a></code> from the <span class="pkg">MNP</span> package is used; and for the biased-reduced multinomial logistic regression (<code>"br.logit"</code>), <code><a href='https://rdrr.io/pkg/brglm2/man/brmultinom.html'>brmultinom</a></code> from the <span class="pkg">brglm2</span> package is used. If the treatment variable is an ordered factor, <code><a href='https://rdrr.io/pkg/MASS/man/polr.html'>polr</a></code> from the <span class="pkg">MASS</span> package is used to fit ordinal regression. Any of the methods allowed in the <code>method</code> argument of <code>polr</code> can be supplied to <code>link</code>. The following estimands are allowed: ATE, ATT, ATC, ATO, and ATM. The weights for each estimand are computed using the standard formulas or those mentioned above. Weights can also be computed using marginal mean weighting through stratification for the ATE, ATT, and ATC. See <code><a href='get_w_from_ps.html'>get_w_from_ps</a></code> for details.</p>
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Continuous Treatments</h3>
<p>For continuous treatments, the generalized propensity score is estimated using linear regression. The conditional density can be specified as normal or another distribution. In addition, kernel density estimation can be used instead of assuming a specific density for the numerator and denominator of the generalized propensity score by setting <code>use.kernel = TRUE</code>. Other arguments to <code><a href='https://rdrr.io/r/stats/density.html'>density</a></code> can be specified to refine the density estimation parameters. <code>plot = TRUE</code> can be specified to plot the density for the numerator and denominator, which can be helpful in diagnosing extreme weights.</p>
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Longitudinal Treatments</h3>
<p>For longitudinal treatments, the weights are the product of the weights estimated at each time point.</p>
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Sampling Weights</h3>
<p>Sampling weights are supported through <code>s.weights</code> in all scenarios except for multinomial treatments with <code>link = "bayes.probit"</code>. Warning messages may appear otherwise about non-integer successes, and these can be ignored.</p>
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Missing Data</h3>
<p>In the presence of missing data, the following value(s) for <code>missing</code> are allowed:</p><dl>
<dt><code>"ind"</code> (default)</dt><dd><p>First, for each variable with missingness, a new missingness indicator variable is created which takes the value 1 if the original covariate is <code>NA</code> and 0 otherwise. The missingness indicators are added to the model formula as main effects. The missing values in the covariates are then replaced with 0s (this value is arbitrary and does not affect estimation). The weight estimation then proceeds with this new formula and set of covariates. The covariates output in the resulting <code>weightit</code> object will be the original covariates with the <code>NA</code>s.</p></dd>
<dt><code>"saem"</code></dt><dd><p>For binary treatments with <code>link = "logit"</code> or continuous treatments, a stochastic approximation version of the EM algorithm (SAEM) is used via the <a href='https://CRAN.R-project.org/package=misaem'><span class="pkg">misaem</span></a> package. No additional covariates are created. See Jiang et al. (2019) for information on this method. In some cases, this is a suitable alternative to multiple imputation.</p></dd>

</dl>


    </div>



    <h2 class="hasAnchor" id="additional-arguments"><a class="anchor" href="#additional-arguments"></a>Additional Arguments</h2>

    <p>The following additional arguments can be specified:</p><dl>
<dt><code>link</code></dt><dd><p>The link used in the generalized linear model for the propensity scores. For binary treatments, <code>link</code> can be any of those allowed by <code><a href='https://rdrr.io/r/stats/family.html'>binomial</a></code>. A <code>br.</code> prefix can be added (e.g., <code>"br.logit"</code>); this changes the fitting method to the <a href='https://rdrr.io/pkg/brglm2/man/brglmFit.html'>bias-corrected generalized linear models</a> implemented in the <a href='https://CRAN.R-project.org/package=brglm2'><span class="pkg">brglm2</span></a> package. For multinomial treatments, <code>link</code> can be "logit", "probit", "bayes.probit", or "br.logit". For ordered treatments, <code>link</code> can be any of those allowed by the <code>method</code> argument of <code><a href='https://rdrr.io/pkg/MASS/man/polr.html'>polr</a></code>. For continuous treatments, <code>link</code> can be any of those allowed by <code><a href='https://rdrr.io/r/stats/family.html'>gaussian</a></code>.</p></dd>

</dl><p>For continuous treatments only, the following arguments may be supplied:</p><dl>
<dt><code>density</code></dt><dd><p>A function corresponding the conditional density of the treatment. The standardized residuals of the treatment model will be fed through this function to produce the numerator and denominator of the generalized propensity score weights. If blank, <code><a href='https://rdrr.io/r/stats/Normal.html'>dnorm</a></code> is used as recommended by Robins et al. (2000). This can also be supplied as a string containing the name of the function to be called. If the string contains underscores, the call will be split by the underscores and the latter splits will be supplied as arguments to the second argument and beyond. For example, if <code>density = "dt_2"</code> is specified, the density used will be that of a t-distribution with 2 degrees of freedom. Using a t-distribution can be useful when extreme outcome values are observed (Naimi et al., 2014). Ignored if <code>use.kernel = TRUE</code> (described below).</p></dd>
<dt><code>use.kernel</code></dt><dd><p>If <code>TRUE</code>, uses kernel density estimation through the <code><a href='https://rdrr.io/r/stats/density.html'>density</a></code> function to estimate the numerator and denominator densities for the weights. If <code>FALSE</code>, the argument to the <code>density</code> parameter is used instead.</p></dd>
<dt><code>bw</code>, <code>adjust</code>, <code>kernel</code>, <code>n</code></dt><dd><p>If <code>use.kernel = TRUE</code>, the arguments to the <code><a href='https://rdrr.io/r/stats/density.html'>density</a></code> function. The defaults are the same as those in <code>density</code> except that <code>n</code> is 10 times the number of units in the sample.</p></dd>
<dt><code>plot</code></dt><dd><p>If <code>use.kernel = TRUE</code> with continuous treatments, whether to plot the estimated density.</p></dd>

</dl>

<p>For binary treatments, additional arguments to <code>glm</code> can be specified as well. The <code>method</code> argument in <code>glm</code> is renamed to <code>glm.method</code>. This can be used to supply alternative fitting functions, such as those implemented in the <a href='https://CRAN.R-project.org/package=glm2'><span class="pkg">glm2</span></a> package. Other arguments to <code>weightit</code> are passed to <code>...</code> in <code>glm</code>. In the presence of missing data with <code>link = "logit"</code> and <code>missing = "saem"</code>, additional arguments are passed to <code><a href='https://rdrr.io/pkg/misaem/man/miss.glm.html'>miss.glm</a></code> and <code><a href='https://rdrr.io/pkg/misaem/man/predict.miss.glm.html'>predict.miss.glm</a></code>, except the <code>method</code> argument in <code><a href='https://rdrr.io/pkg/misaem/man/predict.miss.glm.html'>predict.miss.glm</a></code> is replaced with <code>saem.method</code>.</p>
<p>For multi-category treatments with <code>link = "logit"</code> or <code>"probit"</code>, the default is to use multinomial logistic or probit regression using the <a href='https://CRAN.R-project.org/package=mlogit'><span class="pkg">mlogit</span></a> package. To request that separate binary logistic or probit regressions are run instead, set <code>use.mlogit = FALSE</code>. This can be helpful when <code>mlogit</code> is slow or fails to converge. With <code>link = "logit"</code>, the option <code>use.mnlogit = TRUE</code> can be specified to request that <code><a href='https://rdrr.io/pkg/mnlogit/man/mnlogit.html'>mnlogit</a></code> from the <a href='https://CRAN.R-project.org/package=mnlogit'><span class="pkg">mnlogit</span></a> package is used instead, which can be faster for large datasets.</p>
<p>For continuous treatments in the presence of missing data with <code>missing = "saem"</code>, additional arguments are passed to <code><a href='https://rdrr.io/pkg/misaem/man/miss.lm.html'>miss.lm</a></code> and <code><a href='https://rdrr.io/pkg/misaem/man/predict.miss.lm.html'>predict.miss.lm</a></code>.</p>
    <h2 class="hasAnchor" id="additional-outputs"><a class="anchor" href="#additional-outputs"></a>Additional Outputs</h2>

    
<dl>
<dt><code>obj</code></dt><dd><p>When <code>include.obj = TRUE</code>, the (generalized) propensity score model fit. For binary treatments, the output of the call to <code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code>. For binary treatments with missing data and <code>missing = "saem"</code>, the output of the call to <code><a href='https://rdrr.io/pkg/misaem/man/miss.glm.html'>misaem::miss.glm</a></code>. For ordinal treatments, the output of the call to <code><a href='https://rdrr.io/pkg/MASS/man/polr.html'>polr</a></code>. For multinomial treatments with <code>link = "logit"</code> or <code>"probit"</code> and <code>use.mlogit = TRUE</code>, the output of the call to <code><a href='https://rdrr.io/pkg/mlogit/man/mlogit.html'>mlogit::mlogit</a></code>. For multinomial treatments with <code>use.mlogit = FALSE</code>, a list of the <code>glm</code> fits. For multinomial treatments with <code>link = "br.logit"</code>, the output of the call to <code><a href='https://rdrr.io/pkg/brglm2/man/brmultinom.html'>brglm2::brmultinom</a></code>. For multinomial treatments with <code>link = "bayes.probit"</code>, the output of the call to <code><a href='https://rdrr.io/pkg/MNP/man/mnp.html'>MNP::MNP</a></code>. For continuous treatments, the output of the call to <code>glm</code> (or <code><a href='https://rdrr.io/pkg/misaem/man/miss.lm.html'>misaem::miss.lm</a></code> if <code>missing = "saem"</code>) for the predicted values in the denominator density.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><strong>Binary treatments</strong></p>
<p>- <code>estimand = "ATO"</code></p>
<p>Li, F., Morgan, K. L., &amp; Zaslavsky, A. M. (2018). Balancing covariates via propensity score weighting. Journal of the American Statistical Association, 113(521), 390–400. doi: <a href='https://doi.org/10.1080/01621459.2016.1260466'>10.1080/01621459.2016.1260466</a></p>
<p>- <code>estimand = "ATM"</code></p>
<p>Li, L., &amp; Greene, T. (2013). A Weighting Analogue to Pair Matching in Propensity Score Analysis. The International Journal of Biostatistics, 9(2). doi: <a href='https://doi.org/10.1515/ijb-2012-0030'>10.1515/ijb-2012-0030</a></p>
<p>- <code>estimand = "ATOS"</code></p>
<p>Crump, R. K., Hotz, V. J., Imbens, G. W., &amp; Mitnik, O. A. (2009). Dealing with limited overlap in estimation of average treatment effects. Biometrika, 96(1), 187–199. doi: <a href='https://doi.org/10.1093/biomet/asn055'>10.1093/biomet/asn055</a></p>
<p>- Other estimands</p>
<p>Austin, P. C. (2011). An Introduction to Propensity Score Methods for Reducing the Effects of Confounding in Observational Studies. Multivariate Behavioral Research, 46(3), 399–424. doi: <a href='https://doi.org/10.1080/00273171.2011.568786'>10.1080/00273171.2011.568786</a></p>
<p>- Marginal mean weighting through stratification</p>
<p>Hong, G. (2010). Marginal mean weighting through stratification: Adjustment for selection bias in multilevel data. Journal of Educational and Behavioral Statistics, 35(5), 499–531. doi: <a href='https://doi.org/10.3102/1076998609359785'>10.3102/1076998609359785</a></p>
<p>- Bias-reduced logistic regression</p>
<p>See references for the <span class="pkg">brglm2</span> <a href='https://rdrr.io/pkg/brglm2/man/brglm2.html'>package</a>.</p>
<p>- SAEM logistic regression for missing data</p>
<p>Jiang, W., Josse, J., &amp; Lavielle, M. (2019). Logistic regression with missing covariates — Parameter estimation, model selection and prediction within a joint-modeling framework. Computational Statistics &amp; Data Analysis, 106907. doi: <a href='https://doi.org/10.1016/j.csda.2019.106907'>10.1016/j.csda.2019.106907</a></p>
<p><strong>Multinomial Treatments</strong></p>
<p>- <code>estimand = "ATO"</code></p>
<p>Li, F., &amp; Li, F. (2019). Propensity score weighting for causal inference with multiple treatments. The Annals of Applied Statistics, 13(4), 2389–2415. doi: <a href='https://doi.org/10.1214/19-AOAS1282'>10.1214/19-AOAS1282</a></p>
<p>- <code>estimand = "ATM"</code></p>
<p>Yoshida, K., Hernández-Díaz, S., Solomon, D. H., Jackson, J. W., Gagne, J. J., Glynn, R. J., &amp; Franklin, J. M. (2017). Matching weights to simultaneously compare three treatment groups: Comparison to three-way matching. Epidemiology (Cambridge, Mass.), 28(3), 387–395. doi: <a href='https://doi.org/10.1097/EDE.0000000000000627'>10.1097/EDE.0000000000000627</a></p>
<p>- Other estimands</p>
<p>McCaffrey, D. F., Griffin, B. A., Almirall, D., Slaughter, M. E., Ramchand, R., &amp; Burgette, L. F. (2013). A Tutorial on Propensity Score Estimation for Multiple Treatments Using Generalized Boosted Models. Statistics in Medicine, 32(19), 3388–3414. doi: <a href='https://doi.org/10.1002/sim.5753'>10.1002/sim.5753</a></p>
<p>- Marginal mean weighting through stratification</p>
<p>Hong, G. (2012). Marginal mean weighting through stratification: A generalized method for evaluating multivalued and multiple treatments with nonexperimental data. Psychological Methods, 17(1), 44–60. doi: <a href='https://doi.org/10.1037/a0024918'>10.1037/a0024918</a></p>
<p><strong>Continuous treatments</strong></p>
<p>Robins, J. M., Hernán, M. Á., &amp; Brumback, B. (2000). Marginal Structural Models and Causal Inference in Epidemiology. Epidemiology, 11(5), 550–560.</p>
<p>- Using non-normal conditional densities</p>
<p>Naimi, A. I., Moodie, E. E. M., Auger, N., &amp; Kaufman, J. S. (2014). Constructing Inverse Probability Weights for Continuous Exposures: A Comparison of Methods. Epidemiology, 25(2), 292–299. doi: <a href='https://doi.org/10.1097/EDE.0000000000000053'>10.1097/EDE.0000000000000053</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='weightit.html'>weightit</a></code>, <code><a href='weightitMSM.html'>weightitMSM</a></code>, <code><a href='get_w_from_ps.html'>get_w_from_ps</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://ngreifer.github.io/cobalt/'>"cobalt"</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"lalonde"</span>, package <span class='op'>=</span> <span class='st'>"cobalt"</span><span class='op'>)</span>

<span class='co'>#Balancing covariates between treatment groups (binary)</span>
<span class='op'>(</span><span class='va'>W1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='weightit.html'>weightit</a></span><span class='op'>(</span><span class='va'>treat</span> <span class='op'>~</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>married</span> <span class='op'>+</span>
                  <span class='va'>nodegree</span> <span class='op'>+</span> <span class='va'>re74</span>, data <span class='op'>=</span> <span class='va'>lalonde</span>,
                method <span class='op'>=</span> <span class='st'>"ps"</span>, estimand <span class='op'>=</span> <span class='st'>"ATT"</span>,
                link <span class='op'>=</span> <span class='st'>"probit"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; A <span style='font-style: italic;'>weightit</span><span> object
#&gt;  - method: "ps" (propensity score weighting)
#&gt;  - number of obs.: 614
#&gt;  - sampling weights: none
#&gt;  - treatment: 2-category
#&gt;  - estimand: ATT (focal: 1)
#&gt;  - covariates: age, educ, married, nodegree, re74</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>W1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  </span><span style='text-decoration: underline;'>Summary of weights</span><span>
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Weight ranges</span><span>:
#&gt; 
#&gt;            Min                                  Max
#&gt; treated 1.0000                 ||            1.0000
#&gt; control 0.0176 |---------------------------| 1.8339
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Units with 5 greatest weights by group</span><span>:
#&gt;                                         
#&gt;               1     2     3     4      5
#&gt;  treated      1     1     1     1      1
#&gt;             612   595   409   296    269
#&gt;  control 1.2781 1.351 1.412 1.518 1.8339
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Weight statistics</span><span>:
#&gt; 
#&gt;         Coef of Var   MAD Entropy # Zeros
#&gt; treated       0.000 0.000  -0.000       0
#&gt; control       0.804 0.691  -0.523       0
#&gt; overall       0.648 0.597  -0.261       0
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Effective Sample Sizes</span><span>:
#&gt; 
#&gt;            Control Treated
#&gt; Unweighted  429.       185
#&gt; Weighted    260.83     185</div><div class='input'><span class='fu'><a href='https://ngreifer.github.io/cobalt/reference/bal.tab.html'>bal.tab</a></span><span class='op'>(</span><span class='va'>W1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; </span><span style='text-decoration: underline;'>Call</span><span>
#&gt;  weightit(formula = treat ~ age + educ + married + nodegree + 
#&gt;     re74, data = lalonde, method = "ps", estimand = "ATT", link = "probit")
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Balance Measures</span><span>
#&gt;                Type Diff.Adj
#&gt; prop.score Distance   0.0252
#&gt; age         Contin.   0.0716
#&gt; educ        Contin.  -0.0565
#&gt; married      Binary   0.0058
#&gt; nodegree     Binary   0.0128
#&gt; re74        Contin.  -0.0507
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Effective sample sizes</span><span>
#&gt;            Control Treated
#&gt; Unadjusted  429.       185
#&gt; Adjusted    260.83     185</div><div class='input'>
<span class='co'>#Balancing covariates with respect to race (multinomial)</span>
<span class='op'>(</span><span class='va'>W2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='weightit.html'>weightit</a></span><span class='op'>(</span><span class='va'>race</span> <span class='op'>~</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>married</span> <span class='op'>+</span>
                  <span class='va'>nodegree</span> <span class='op'>+</span> <span class='va'>re74</span>, data <span class='op'>=</span> <span class='va'>lalonde</span>,
                method <span class='op'>=</span> <span class='st'>"ps"</span>, estimand <span class='op'>=</span> <span class='st'>"ATE"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; A </span><span style='font-style: italic;'>weightit</span><span> object
#&gt;  - method: "ps" (propensity score weighting)
#&gt;  - number of obs.: 614
#&gt;  - sampling weights: none
#&gt;  - treatment: 3-category (black, hispan, white)
#&gt;  - estimand: ATE
#&gt;  - covariates: age, educ, married, nodegree, re74</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>W2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  </span><span style='text-decoration: underline;'>Summary of weights</span><span>
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Weight ranges</span><span>:
#&gt; 
#&gt;           Min                                   Max
#&gt; black  1.4528 |---------------------------| 30.8071
#&gt; hispan 1.7990  |---------------------|      25.9532
#&gt; white  1.1123 |-|                            3.9770
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Units with 5 greatest weights by group</span><span>:
#&gt;                                               
#&gt;             485     231    226     182     181
#&gt;   black   7.532  7.6243 8.5246 12.3509 30.8071
#&gt;             564     392    371     345     269
#&gt;  hispan 15.9922 16.7517 18.784 23.4106 25.9532
#&gt;             599     589    437     432     404
#&gt;   white   3.686  3.6864  3.712  3.7842   3.977
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Weight statistics</span><span>:
#&gt; 
#&gt;         Coef of Var   MAD Entropy # Zeros
#&gt; black         0.890 0.426   1.143       0
#&gt; hispan        0.541 0.404   2.263       0
#&gt; white         0.382 0.317   0.787       0
#&gt; overall       0.983 0.570   1.392       0
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Effective Sample Sizes</span><span>:
#&gt; 
#&gt;            black hispan  white
#&gt; Unweighted 243.   72.   299.  
#&gt; Weighted   135.8  55.86 261.02</div><div class='input'><span class='fu'><a href='https://ngreifer.github.io/cobalt/reference/bal.tab.html'>bal.tab</a></span><span class='op'>(</span><span class='va'>W2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; </span><span style='text-decoration: underline;'>Call</span><span>
#&gt;  weightit(formula = race ~ age + educ + married + nodegree + re74, 
#&gt;     data = lalonde, method = "ps", estimand = "ATE")
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Balance summary across all treatment pairs</span><span>
#&gt;             Type Max.Diff.Adj
#&gt; age      Contin.       0.0419
#&gt; educ     Contin.       0.1276
#&gt; married   Binary       0.0500
#&gt; nodegree  Binary       0.0605
#&gt; re74     Contin.       0.2023
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Effective sample sizes</span><span>
#&gt;            black hispan  white
#&gt; Unadjusted 243.   72.   299.  
#&gt; Adjusted   135.8  55.86 261.02</div><div class='input'>
<span class='co'>#Balancing covariates with respect to re75 (continuous)</span>
<span class='op'>(</span><span class='va'>W3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='weightit.html'>weightit</a></span><span class='op'>(</span><span class='va'>re75</span> <span class='op'>~</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>married</span> <span class='op'>+</span>
                  <span class='va'>nodegree</span> <span class='op'>+</span> <span class='va'>re74</span>, data <span class='op'>=</span> <span class='va'>lalonde</span>,
                method <span class='op'>=</span> <span class='st'>"ps"</span>, use.kernel <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; A </span><span style='font-style: italic;'>weightit</span><span> object
#&gt;  - method: "ps" (propensity score weighting)
#&gt;  - number of obs.: 614
#&gt;  - sampling weights: none
#&gt;  - treatment: continuous
#&gt;  - covariates: age, educ, married, nodegree, re74</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>W3</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  </span><span style='text-decoration: underline;'>Summary of weights</span><span>
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Weight ranges</span><span>:
#&gt; 
#&gt;       Min                                   Max
#&gt; all 0.088 |---------------------------| 83.1017
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Units with 5 greatest weights by group</span><span>:
#&gt;                                           
#&gt;         485     484    483     482     481
#&gt;  all 56.933 56.9865 70.237 77.1173 83.1017
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Weight statistics</span><span>:
#&gt; 
#&gt;     Coef of Var   MAD Entropy # Zeros
#&gt; all       2.908 1.049   2.082       0
#&gt; 
#&gt; - </span><span style='font-style: italic;'>Effective Sample Sizes</span><span>:
#&gt; 
#&gt;             Total
#&gt; Unweighted 614.  
#&gt; Weighted    65.03</div><div class='input'><span class='fu'><a href='https://ngreifer.github.io/cobalt/reference/bal.tab.html'>bal.tab</a></span><span class='op'>(</span><span class='va'>W3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; </span><span style='text-decoration: underline;'>Call</span><span>
#&gt;  weightit(formula = re75 ~ age + educ + married + nodegree + re74, 
#&gt;     data = lalonde, method = "ps", use.kernel = TRUE)
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Balance Measures</span><span>
#&gt;             Type Corr.Adj
#&gt; age      Contin.  -0.0501
#&gt; educ     Contin.   0.0016
#&gt; married   Binary  -0.0427
#&gt; nodegree  Binary  -0.0196
#&gt; re74     Contin.  -0.0773
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Effective sample sizes</span><span>
#&gt;             Total
#&gt; Unadjusted 614.  
#&gt; Adjusted    65.03</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


