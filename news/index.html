<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • WeightIt</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><meta property="og:image" content="https://ngreifer.github.io/WeightIt/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">WeightIt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.14.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/WeightIt.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/estimating-effects.html">Estimating Effects After Weighting</a>
    <a class="dropdown-item" href="../articles/installing-packages.html">Installing Supporting Packages</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ngreifer/WeightIt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Changelog</h1>
      <small>Source: <a href="https://github.com/ngreifer/WeightIt/blob/HEAD/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.14.2" id="weightit-0142">WeightIt 0.14.2<a class="anchor" aria-label="anchor" href="#weightit-0142"></a></h2>
<ul><li><p>Fixed a bug when using <code>estimand = "ATC"</code> with multi-category treatments. (<a href="https://github.com/ngreifer/WeightIt/issues/47" class="external-link">#47</a>)</p></li>
<li><p>Fixed a bug in the Estimating Effects vignette. (<a href="https://github.com/ngreifer/WeightIt/issues/46" class="external-link">#46</a>)</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.14.1" id="weightit-0141">WeightIt 0.14.1<a class="anchor" aria-label="anchor" href="#weightit-0141"></a></h2><p class="text-muted">CRAN release: 2023-05-09</p>
<ul><li><p><code>cobalt</code> version 4.5.1 or greater is now required.</p></li>
<li><p>Fixed a bug when using balance Super Learner with <code>cobalt</code> 4.5.1.</p></li>
<li><p>Added a section to the Estimating Effects vignette (<code><a href="../articles/estimating-effects.html">vignette("estimating-effects")</a></code>) on estimating the effect of a continuous treatment after weighting.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.14.0" id="weightit-0140">WeightIt 0.14.0<a class="anchor" aria-label="anchor" href="#weightit-0140"></a></h2><p class="text-muted">CRAN release: 2023-04-12</p>
<ul><li><p>Added energy balancing for continuous treatments, requested using <code>method = "energy"</code>, as described in <a href="https://doi.org/10.1080/01621459.2023.2213485" class="external-link">Huling et al. (2023)</a>. These weights minimize the distance covariance between the treatment and covariates while maintaining representativeness. This method supports exact balance constraints, distributional balance constraints, and sampling weights. The implementation is similar to that in the <code>independenceWeights</code> package. See <code><a href="../reference/method_energy.html">?method_energy</a></code> for details.</p></li>
<li><p>Added a new vignette on estimating effects after weighting, accessible using <code><a href="../articles/estimating-effects.html">vignette("estimating-effects", package = "WeightIt")</a></code>. The new workflow relies on the <code>marginaleffects</code> package. The main vignette (<code><a href="../articles/WeightIt.html">vignette("WeightIt")</a></code>) has been modernized as well.</p></li>
<li><p>Added a new dataset, <code>msmdata</code>, to demonstrate capabilities for longitudinal treatments. <code>twang</code> is no longer a dependency.</p></li>
<li><p>Methods that use a balance criterion to select a tuning parameter, in particular GBM and balance Super Learner, now rely on <code>cobalt</code>’s <code><a href="https://ngreifer.github.io/cobalt/reference/bal.compute.html" class="external-link">bal.init()</a></code> and <code><a href="https://ngreifer.github.io/cobalt/reference/bal.compute.html" class="external-link">bal.compute()</a></code> functionality, which adds new balance criteria. The <code>stop.method</code> argument for these functions has been renamed to <code>criterion</code> and <code>help("stop.method")</code> has been removed; the same page is now available at <code><a href="https://ngreifer.github.io/cobalt/reference/bal.compute.html" class="external-link">help("bal.compute", package = "cobalt")</a></code>, which describes the additional statistics available. This also fixes some bugs that were present in some balance criteria.</p></li>
<li><p>Renamed <code>method = "ps"</code> to <code>method = "glm"</code>. <code>"ps"</code> continues to work as it always had for back compatibility. <code>"glm"</code> is a more descriptive name since many methods use propensity scores; what distinguishes this method is that it uses generalized linear models.</p></li>
<li><p>Using <code>method = "ebcw"</code> for empirical balancing calibration weighting is no longer available because the <code>ATE</code> package has been removed. Use <code>method = "ebal"</code> for entropy balancing instead, which is essentially identical.</p></li>
<li><p>Updated the <code><a href="../reference/trim.html">trim()</a></code> documentation to clarify the form of trimming that is implemented (i.e., winsorizing). Suggested by David Novgorodsky.</p></li>
<li><p>Fixed bugs when some <code>s.weights</code> are equal to zero with <code>method = "ebal"</code>, “<code>cbps"</code>, and <code>"energy"</code>. Suggested by <a href="https://github.com/statzhero" class="external-link">@statzhero</a>. (<a href="https://github.com/ngreifer/WeightIt/issues/41" class="external-link">#41</a>)</p></li>
<li><p>Improved performance of <code>method = "energy"</code> for the ATT.</p></li>
<li><p>Fixed a bug when using <code>method = "energy"</code> with <code>by</code>.</p></li>
<li><p>With <code>method = "energy"</code>, setting <code>int = TRUE</code> automatically sets <code>moments = 1</code> if unspecified.</p></li>
<li><p>Errors and warnings have been updated to use <code>chk</code>.</p></li>
<li><p>The missingness indicator approach now imputes the variable median rather than 0 for missing values. This will not change the performance of most methods, but change others, and doesn’t affect balance assessment.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.13.1" id="weightit-0131">WeightIt 0.13.1<a class="anchor" aria-label="anchor" href="#weightit-0131"></a></h2><p class="text-muted">CRAN release: 2022-06-28</p>
<ul><li><p>For ordinal multi-category treatments, setting <code>link = "br.logit"</code> now uses <code><a href="https://rdrr.io/pkg/brglm2/man/bracl.html" class="external-link">brglm2::bracl()</a></code> to fit a bias-reduced ordinal regression model.</p></li>
<li><p>Added the vignette “Installing Supporting Packages” to explain how to install the various packages that might be needed for <code>WeightIt</code> to use certain methods, including when the package is not on CRAN. See the vignette at <code><a href="../articles/installing-packages.html">vignette("installing-packages")</a></code>.</p></li>
<li><p>Fixed a bug that would occur when a factor or character predictor with a single level was passed to <code><a href="../reference/weightit.html">weightit()</a></code>.</p></li>
<li><p>Improved the code for entropy balancing, fixing a bug when using <code>s.weights</code> with a continuous treatment and improving messages when the optimization fails to converge. (<a href="https://github.com/ngreifer/WeightIt/issues/33" class="external-link">#33</a>)</p></li>
<li><p>Improved robustness of documentation to missing packages.</p></li>
<li><p>Updated the logo, thanks to <a href="https://stillben.com" class="external-link">Ben Stillerman</a>.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.13.0" id="weightit-0130">WeightIt 0.13.0<a class="anchor" aria-label="anchor" href="#weightit-0130"></a></h2>
<ul><li><p>Fixed a bug that would occur when the <code>formula.tools</code> package was loaded, which would occur most commonly when <code>logistf</code> was loaded. It would cause the error <code>The treatment and covariates must have the same number of units.</code> (<a href="https://github.com/ngreifer/WeightIt/issues/25" class="external-link">#25</a>)</p></li>
<li><p>Fixed a bug where the <code>info</code> component would not be included in the output of <code><a href="../reference/weightit.html">weightit()</a></code> when using <code>method = "super"</code>.</p></li>
<li><p>Added the ability to specify <code>num.formula</code> as a list of formulas in <code><a href="../reference/weightitMSM.html">weightitMSM()</a></code>. This is primarily to get around the fact that when <code>stabilize = TRUE</code>, a fully saturated model with all treatments is used to compute the stabilization factor, which, for many time points, is time-consuming and may be impossible (especially if not all treatment combinations are observed). Thanks to <a href="https://github.com/maellecoursonnais" class="external-link">@maellecoursonnais</a> for bringing up this issue (<a href="https://github.com/ngreifer/WeightIt/issues/27" class="external-link">#27</a>).</p></li>
<li><p><code>ps.cont()</code> has been retired since the same functionality is available using <code><a href="../reference/weightit.html">weightit()</a></code> with <code>method = "gbm"</code> and in the <code>twangContinuous</code> package.</p></li>
<li><p>With <code>method = "energy"</code>, a new argument, <code>lambda</code>, can be supplied, which puts a penalty on the square of the weights to control the effective sample size. Typically this is not needed but can help when the balancing is too aggressive.</p></li>
<li><p>With <code>method = "energy"</code>, <code>min.w</code> can now be negative, allowing for negative weights.</p></li>
<li><p>With <code>method = "energy"</code>, <code>dist.mat</code> can now be supplied as the name of a method to compute the distance matrix: <code>"scaled_euclidean"</code>, <code>"mahalanobis"</code>, or <code>"euclidean"</code>.</p></li>
<li><p>Support for negative weights added to <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>. Negative weights are possible (though not by default) when using <code>method = "energy"</code> or <code>method = "optweight"</code>.</p></li>
<li><p>Fixed a bug where <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> would fail to converge with <code>method = "ps"</code> for binary treatments due to bad starting values. (<a href="https://github.com/ngreifer/WeightIt/issues/31" class="external-link">#31</a>)</p></li>
<li><p><code>miss = "saem"</code> can once again be used with <code>method = "ps"</code> when missing values are present in the covariates.</p></li>
<li><p>Fixed bugs with processing input formulas.</p></li>
<li><p>An error is now thrown if an incorrect <code>link</code> is supplied with <code>method = "ps"</code>.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.12.0" id="weightit-0120">WeightIt 0.12.0<a class="anchor" aria-label="anchor" href="#weightit-0120"></a></h2><p class="text-muted">CRAN release: 2021-04-03</p>
<ul><li><p>The use of <code>method = "twang"</code> has been retired and will now give an error message. Use <code>method = "gbm"</code> for nearly identical functionality with more options, as detailed at <code><a href="../reference/method_gbm.html">?method_gbm</a></code>.</p></li>
<li><p>With multinomial treatments with <code>link = "logit"</code> (the default), if the <code>mclogit</code> package is installed, it can be requested for estimating the propensity score by setting the option <code>use.mclogit = TRUE</code>, which uses <code><a href="https://rdrr.io/pkg/mclogit/man/mblogit.html" class="external-link">mclogit::mblogit()</a></code>. It should give the same results as the default, which uses <code>mlogit</code>, but can be faster and so is recommended.</p></li>
<li><p>Added a <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method for <code>summary.weightitMSM</code> objects that functions just like <code><a href="../reference/summary.weightit.html">plot.summary.weightit()</a></code> for each time point.</p></li>
<li><p>Fixed a bug in <code><a href="../reference/summary.weightit.html">summary.weightit()</a></code> where the labels of the top weights were incorrect. Thanks to Adam Lilly.</p></li>
<li><p>Fixed a bug in <code><a href="../reference/sbps.html">sbps()</a></code> when using a stochastic search (i.e., <code>full.search = FALSE</code> or more than 8 moderator levels). (<a href="https://github.com/ngreifer/WeightIt/issues/17" class="external-link">#17</a>)</p></li>
<li><p>Fixed a bug that would occur when all weights in a treatment group were <code>NA</code>. Bad weights (i.e., all the same) now produce a warning rather than an error so the weights can be diagnosed manually. (<a href="https://github.com/ngreifer/WeightIt/issues/18" class="external-link">#18</a>)</p></li>
<li><p>Fixed a bug when using <code>method = "energy"</code> with <code>estimand = "ATE"</code> and <code>improved = TRUE</code> (the default). The between-treatment energy distance contribution was half of what it should have been; this has now been corrected.</p></li>
<li><p>Added L1 median measure as a balance criterion. See <code>?stop.method</code> for details.</p></li>
<li><p>Fixed a bug where logical treatments would yield an error. (<a href="https://github.com/ngreifer/WeightIt/issues/21" class="external-link">#21</a>)</p></li>
<li><p>Fixed a bug where <code>Warning: Deprecated</code> would appear sometimes when <code>purrr</code> (part of the <code>tidyverse</code>) was loaded. (<a href="https://github.com/ngreifer/WeightIt/issues/22" class="external-link">#22</a>) Thanks to MrFlick on StackOverflow for the <a href="https://stackoverflow.com/a/66897921/6348551" class="external-link">solution</a>.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.11.0" id="weightit-0110">WeightIt 0.11.0<a class="anchor" aria-label="anchor" href="#weightit-0110"></a></h2><p class="text-muted">CRAN release: 2021-02-02</p>
<ul><li><p>Added support for estimating propensity scores using Bayesian additive regression trees (BART) with <code>method = "bart"</code>. This method fits a BART model for the treatment using functions in the <code>dbarts</code> package to estimate propensity scores that are used in weights. Binary, multinomial, and continuous treatments are supported. BART uses Bayesian priors for its hyperparameters, so no hyperparameter tuning is necessary to get well-performing predictions.</p></li>
<li><p>Fixed a bug when using <code>method = "gbm"</code> with <code>stop.method = "cv{#}"</code>.</p></li>
<li><p>Fixed a bug when setting <code>estimand = "ATC"</code> for methods that produce a propensity score. In the past, the output propensity score was the probability of being in the control group; now, it is the probability of being in the treated group, as it is for all other estimands. This does not affect the weights.</p></li>
<li><p>Setting <code>method = "twang"</code> is now deprecated. Use <code>method = "gbm"</code> for improved performance and increased functionality. <code>method = "twang"</code> relies on the <code>twang</code> package; <code>method = "gbm"</code> calls <code>gbm</code> directly.</p></li>
<li><p>Using <code>method = "ebal"</code> no longer requires the <code>ebal</code> package. Instead, <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> is used, as it has been with continuous treatments. Balance is a little better, but some options have been removed.</p></li>
<li><p>When using <code>method = "ebal"</code> with continuous treatments, a new argument, <code>d.moments</code>, can now be specified. This controls the number of moments of the covariate and treatment distributions that are constrained to be the same in the weighted sample as they are in the original sample. Vegetabile et al. (2020) recommend setting <code>d.moments</code> to at least 3 to ensure generalizability and reduce bias due to effect modification.</p></li>
<li><p>Made some minor changes to <code><a href="../reference/summary.weightit.html">summary.weightit()</a></code> and <code><a href="../reference/summary.weightit.html">plot.summary.weightit()</a></code>. Fixed how negative entropy was computed.</p></li>
<li><p>The option <code>use.mnlogit</code> in <code><a href="../reference/weightit.html">weightit()</a></code> with multi-category treatments and <code>method = "ps"</code> has been removed because <code>mnlogit</code> appears uncooperative.</p></li>
<li><p>Fixed a bug (<a href="https://github.com/ngreifer/WeightIt/issues/16" class="external-link">#16</a>) when using <code>method = "cbps"</code> with factor variables, thanks to <a href="https://github.com/danielebottigliengo" class="external-link">@danielebottigliengo</a>.</p></li>
<li><p>Fixed a bug when using binary factor treatments, thanks to Darren Stewart.</p></li>
<li><p>Cleaned up the documentation.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.10.2" id="weightit-0102">WeightIt 0.10.2<a class="anchor" aria-label="anchor" href="#weightit-0102"></a></h2><p class="text-muted">CRAN release: 2020-08-27</p>
<ul><li>Fixed a bug where treatment values were accidentally switched for some methods.</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.10.1" id="weightit-0101">WeightIt 0.10.1<a class="anchor" aria-label="anchor" href="#weightit-0101"></a></h2><p class="text-muted">CRAN release: 2020-08-12</p>
<ul><li><p>With <code>method = "gbm"</code>, added the ability to tune hyperparameters like <code>interaction.depth</code> and <code>distribution</code> using the same criteria as is used to select the optimal tree. A summary of the tuning results is included in <code>info</code> in the <code>weightit</code> output object.</p></li>
<li><p>Fixed a bug where <code>moments</code> and <code>int</code> were ignored unless both were specified.</p></li>
<li><p>Effective sample sizes now print only up to two digits (believe me, you don’t need three) and print more cleanly with whole numbers.</p></li>
<li><p>Fixed a bug when using <code>by</code>, thanks to <a href="https://github.com/frankpopham" class="external-link">@frankpopham</a>. (<a href="https://github.com/ngreifer/WeightIt/issues/11" class="external-link">#11</a>)</p></li>
<li><p>Fixed a bug when using <code>weightitMSM</code> with methods that process <code>int</code> and <code>moments</code> (though you probably shouldn’t use them anyway). Thanks to Sven Reiger.</p></li>
<li><p>Fixed a bug when using <code>method = "npcbps"</code> where weights could be excessively small and mistaken for all being the same. The weights now sum to the number of units.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.10.0" id="weightit-0100">WeightIt 0.10.0<a class="anchor" aria-label="anchor" href="#weightit-0100"></a></h2><p class="text-muted">CRAN release: 2020-07-07</p>
<ul><li><p>Added support for energy balancing with <code>method = "energy"</code>. This method minimizes the energy distance between samples, which is a multivariate distance measure. This method uses code written specifically for <code>WeightIt</code> (i.e., it does not call a package specifically designed for energy balancing) using the <code>osqp</code> package for the optimization (same as <code>optweight</code>). See Huling &amp; Mak (2020) for details on this method. Also included is an option to require exact balance on moments of the covariates while minimizing the energy distance. The method works for binary and multinomial treatments with the ATE, ATT, or ATC. Sampling weights are supported. Because the method requires the calculation and manipulation of a distance matrix for all units, it can be slow and/or memory intensive for large datasets.</p></li>
<li><p>Improvements to <code>method = "gbm"</code> and to <code>method = "super"</code> with <code>SL.method = "method.balance"</code>. A new suite of <code>stop.method</code>s are allowed. For binary treatments, these include the energy distance, sample Mahalanobis distance, and pseudo-R2 of the weighted treatment model, among others. See <code>?stop.method</code> for allowable options. In addition, performance for both is quite a bit faster.</p></li>
<li><p>With multinomial treatments with <code>link = "logit"</code> (the default), if the <code>mnlogit</code> package is installed, it can be requested for estimating the propensity score by setting the option <code>use.mnlogit = TRUE</code>. It should give the same results as the default, which uses <code>mlogit</code>, but can be faster for large datasets.</p></li>
<li><p>Added option <code>estimand = "ATOS"</code> for the “optimal subset” treatment effect as described by Crump et al. (2009). This estimand finds the subset of units who, with ATE weights applied, yields a treatment effect with the lowest variance, assuming homoscedasticity (and other assumptions). It is only available for binary treatments with <code>method = "ps"</code>. In general it makes more sense to use <code>estimand = "ATO"</code> if you want a low-variance estimate and don’t care about the target population, but I added this here for completeness. It is available in <code><a href="../reference/get_w_from_ps.html">get_w_from_ps()</a></code> as well.</p></li>
<li><p><code><a href="../reference/make_full_rank.html">make_full_rank()</a></code> is now faster.</p></li>
<li><p>Cleaning up of some error messages.</p></li>
<li><p>Fixed a bug when using <code>link = "log"</code> for <code>method = "ps"</code> with binary treatments.</p></li>
<li><p>Fixed a bug when using <code>method = "cbps"</code> with continuous treatments and sampling weights. Previously the returned weights included the sampling weights multiplied in; now they are separated, as they are in all other scenarios and for all other methods.</p></li>
<li><p>Improved processing of non-0/1 binary treatments, including for <code>method = "gbm"</code>. A guess will be made as to which treatment is considered “treated”; this only affects produced propensity scores but not weights.</p></li>
<li><p>Changed default value of <code>at</code> in <code><a href="../reference/trim.html">trim()</a></code> from .99 to 0.</p></li>
<li><p>Added output for the number of weights equal to zero in <code>summary.weightit</code>. This can be especially helpful when using <code>"optweight"</code> or <code>"energy"</code> methods or when using <code>estimand = "ATOS"</code>.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.9.0" id="weightit-090">WeightIt 0.9.0<a class="anchor" aria-label="anchor" href="#weightit-090"></a></h2><p class="text-muted">CRAN release: 2020-02-11</p>
<ul><li><p>Added support for entropy balancing (<code>method = "ebal"</code>) for continuous treatments as described by Tübbicke (2020). Relies on hand-written code contributed by Stefan Tübbicke rather than another R package. Sampling weights and base weights are both supported as they are with binary and multi-category treatments.</p></li>
<li><p>Added support for Balance SuperLearner as described by Pirracchio and Carone (2018) with <code>method = "super"</code>. Rather than using NNLS to choose the optimal combination of predictions, you can now optimize balance. To do so, set <code>SL.method = "method.balance"</code>. You will need to set an argument to <code>stop.method</code>, which works identically to how it does for <code>method = "gbm"</code>. For example, for <code>stop.method = "es.max"</code>, the predicted values given will be the combination of predicted values that minimizes the largest absolute standardized mean difference of the covariates in the sample weighted using the predicted values as propensity scores.</p></li>
<li><p>Changed some of the statistics displayed when using <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>: the weight ratio is gone (because weights can be 0, which is not problematic but would explode the ratio), and the mean absolute deviation and entropy of the weights are now present.</p></li>
<li><p>Added <code>crayon</code> for prettier printing of <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> output.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.8.0" id="weightit-080">WeightIt 0.8.0<a class="anchor" aria-label="anchor" href="#weightit-080"></a></h2><p class="text-muted">CRAN release: 2020-01-12</p>
<ul><li><p>Formula interfaces now accept <code>poly(x, .)</code> and other matrix-generating functions of variables, including the <code>rms</code>-class-generating functions from the <code>rms</code> package (e.g., <code>pol()</code>, <code>rcs()</code>, etc.) (the <code>rms</code> package must be loaded to use these latter ones) and the <code>basis</code>-class-generating functions from the <code>splines</code> package (i.e., <code>bs()</code> and <code>ns()</code>). A bug in an early version of this was found by <a href="https://github.com/ahinton-mmc" class="external-link">@ahinton-mmc</a>.</p></li>
<li><p>Added support for marginal mean weighting through stratification (MMWS) as described by Hong (2010, 2012) for <code><a href="../reference/weightit.html">weightit()</a></code> and <code><a href="../reference/get_w_from_ps.html">get_w_from_ps()</a></code> through the <code>subclass</code> argument (see References at <code><a href="../reference/get_w_from_ps.html">?get_w_from_ps</a></code>). With this method, subclasses are formed based on the propensity score and weights are computed based on the number of units in each subclass. MMWS can be used with any method that produces a propensity score. The implementation here ensures all subclasses have a least one member by filling in empty subclasses with neighboring units.</p></li>
<li><p>Added <code>stabilize</code> option to <code><a href="../reference/get_w_from_ps.html">get_w_from_ps()</a></code>.</p></li>
<li><p>A new <code>missing</code> argument has been added to <code><a href="../reference/weightit.html">weightit()</a></code> to choose how missing data in the covariates is handled. For most methods, only <code>"ind"</code> (i.e., missing indicators with single-value imputation) is allowed, but for <code>"ps"</code>, <code>"gbm"</code>, and <code>"twang"</code>, other methods are possible. For <code>method = "ps"</code>, a stochastic approximation of the EM algorithm (SAEM) can be used through the <code>misaem</code> package by setting <code>missing = "saem"</code>.</p></li>
<li><p>For continuous treatments with the <code>"ps"</code>, <code>"gbm"</code>, and <code>"super"</code> methods (i.e., where the conditional density of the treatment needs to be estimated), the user can now supply their own density as a string or function rather than using the normal density or kernel density estimation. For example, to use the density of the t-distribution with 3 degrees of freedom, one can set <code>density = "dt_3"</code>. T-distributions often work better than normal distributions for extreme values of the treatment.</p></li>
<li><p>Some methods now have an <code>info</code> component in the output object. This contains information that might be useful in diagnosing or reporting the method. For example, when <code>method = "gbm"</code>, <code>info</code> contains the tree that was used to compute the weights and the balance resulting from all the trees, which can be plotted using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>. When <code>method = "super"</code>, <code>info</code> contains the coefficients in the stacking model and the cross-validation risk of each of the component methods.</p></li>
<li><p>For <code>method = "gbm"</code>, the best tree can be chosen using cross validation rather than balance by setting <code>stop.method = "cv5"</code>, e.g., to do 5-fold cross-validation.</p></li>
<li><p>For <code>method = "gbm"</code>, a new optional argument <code>start.tree</code> can be set to select the tree at which balance begins to be computed. This can speed things up when you know that the best tree is not within the first 100 trees, for example.</p></li>
<li><p>When using <code>method = "gbm"</code> with multi-category treatments and estimands other than the <code>ATE</code>, <code>ATT</code>, or <code>ATC</code> are used with standardized mean differences as the stopping rule, the mean differences will be between the weighted overall sample and each treatment group. Otherwise, some efficiency improvements.</p></li>
<li><p>When using <code>method = "ps"</code> with multi-category treatments, the use of <code>use.mlogit = FALSE</code> to request multiple binary regressions instead of multinomial regression is now documented and an associated bug is now fixed, thanks to <a href="https://github.com/ahinton-mmc" class="external-link">@ahinton-mmc</a>.</p></li>
<li><p>When use <code>method = "super"</code>, one can now set <code>discrete = TRUE</code> to use discrete SuperLearner instead of stacked SuperLearner, but you probably shouldn’t.</p></li>
<li><p><code>moments</code> and <code>int</code> can now be used with <code>method = "npcbps"</code>.</p></li>
<li><p>Performance enhancements.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.7.1" id="weightit-071">WeightIt 0.7.1<a class="anchor" aria-label="anchor" href="#weightit-071"></a></h2><p class="text-muted">CRAN release: 2019-10-30</p>
<ul><li><p>Fixed bug when using <code><a href="../reference/weightit.html">weightit()</a></code> inside another function that passed a <code>by</code> argument explicitly. Also changed the syntax for <code>by</code>; it must now either be a string (which was always possible) or a one-sided formula with the stratifying variable on the right-hand side. To use a variable that is not in <code>data</code>, you must use the formula interface.</p></li>
<li><p>Fixed bug when trying to use <code>ps</code> with <code>by</code> in <code><a href="../reference/weightit.html">weightit()</a></code>.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.7.0" id="weightit-070">WeightIt 0.7.0<a class="anchor" aria-label="anchor" href="#weightit-070"></a></h2><p class="text-muted">CRAN release: 2019-10-16</p>
<ul><li><p>Added new <code><a href="../reference/sbps.html">sbps()</a></code> function for estimating subgroup balancing propensity score weights, including both the standard method and a new smooth version.</p></li>
<li><p>Setting <code>method = "gbm"</code> and <code>method = "twang"</code> will now do two different things. <code>method = "gbm"</code> uses <code>gbm</code> and <code>cobalt</code> functions to estimate the weights and is much faster, while <code>method = "twang"</code> uses <code>twang</code> functions to estimate the weights. The results are similar between the two methods. Prior to this version, <code>method = "gbm"</code> and <code>method = "twang"</code> both did what <code>method = "twang"</code> does now.</p></li>
<li><p>Bug fixes when <code>stabilize = TRUE</code>, thanks to <a href="https://github.com/ulriksartipy" class="external-link">@ulriksartipy</a> and Sven Rieger.</p></li>
<li><p>Fixes for using <code>base.weight</code> argument with <code>method = "ebal"</code>. Now the supplied vector should have a length equal to the number of units in the dataset (in contrast to its use in <code>ebalance</code>, which requires a length equal to the number of control units).</p></li>
<li><p>Restored dependency on <code>cobalt</code> for examples and vignette.</p></li>
<li><p>When <code>method = "ps"</code> and the treatment is ordered (i.e., ordinal), <code><a href="https://rdrr.io/pkg/MASS/man/polr.html" class="external-link">MASS::polr()</a></code> is used to fit an ordinal regression. Make the treatment un-ordered to to use multinomial regression instead.</p></li>
<li><p>Added support for using bias-reduced fitting functions when <code>method = "ps"</code> as provided by the <code>brglm2</code> package. These can be accessed by changing the <code>link</code> to, for example, <code>"br.logit"</code> or <code>"br.probit"</code>. For multinomial treatments, setting <code>link = "br.logit"</code> fits a bias-reduced multinomial regression model using <code><a href="https://rdrr.io/pkg/brglm2/man/brmultinom.html" class="external-link">brglm2::brmultinom()</a></code>. This can be helpful when regular maximum likelihood models fail to converge, though this may also be a sign of lack of overlap.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.6.0" id="weightit-060">WeightIt 0.6.0<a class="anchor" aria-label="anchor" href="#weightit-060"></a></h2><p class="text-muted">CRAN release: 2019-09-05</p>
<ul><li><p>Bug fixes. Functions now work better when used inside other functions (e.g., <code>lapply</code>).</p></li>
<li><p>Behavior of <code><a href="../reference/weightit.html">weightit()</a></code> in the presence of non-<code>NULL</code> <code>focal</code> has changed. When <code>focal</code> is specified, <code>estimand</code> is assumed to be <code>ATT</code>. Previously, <code>focal</code> would be ignored unless <code>estimand = "ATT"</code>.</p></li>
<li><p>Processing of <code>estimand</code> and <code>focal</code> is improved. Functions are smarter about guessing which group is the focal group when one isn’t specified, especially with non-numeric treatments. <code>focal</code> can now be used with <code>estimand = "ATC"</code> to indicate which group is the control group, so <code>"ATC"</code> and <code>"ATT"</code> now function more similarly.</p></li>
<li><p>Added function <code><a href="../reference/get_w_from_ps.html">get_w_from_ps()</a></code> to transform propensity scores into weights (instead of having to go through <code><a href="../reference/weightit.html">weightit()</a></code>).</p></li>
<li><p>Added functions <code><a href="../reference/as.weightit.html">as.weightit()</a></code> and <code><a href="../reference/as.weightit.html">as.weightitMSM()</a></code> to convert weights and treatments and other components into <code>weightit</code> objects so that <code><a href="../reference/summary.weightit.html">summary.weightit()</a></code> can be used on them.</p></li>
<li><p>Updated documentation to describe how missing data in the covariates is handled. Some bugs related to missing data have been fixed as well, thanks to Yong Hao Pua.</p></li>
<li><p><code>ps.cont()</code> had the “z-transformed correlation” options removed to simplify output. This function and its supporting functions will be deprecated as soon as the new version of <code>twang</code> is released.</p></li>
<li><p>When using <code>method = "ps"</code> or <code>method = "super"</code> with continuous treatments, setting <code>use.kernel = TRUE</code> and <code>plot = TRUE</code>, the plot is now made with <code>ggplot2</code> rather than the base R plots.</p></li>
<li><p>Added <code><a href="../reference/summary.weightit.html">plot.summary.weightit()</a></code> to plot the distribution of weights (a feature also in <code>optweight</code>).</p></li>
<li><p>Removed dependency on <code>cobalt</code> temporarily, which means the examples and vignette won’t run.</p></li>
<li><p>Added <code>ggplot2</code> to Imports.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.5.1" id="weightit-051">WeightIt 0.5.1<a class="anchor" aria-label="anchor" href="#weightit-051"></a></h2><p class="text-muted">CRAN release: 2019-01-16</p>
<ul><li><p>Fixed a bug when using the <code>ps</code> argument in <code><a href="../reference/weightit.html">weightit()</a></code>.</p></li>
<li><p>Fixed a bug when setting <code>include.obj = TRUE</code> in <code><a href="../reference/weightitMSM.html">weightitMSM()</a></code>.</p></li>
<li><p>Added warnings for using certain methods with longitudinal treatments as they are not validated and may lead to incorrect inferences.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.5.0" id="weightit-050">WeightIt 0.5.0<a class="anchor" aria-label="anchor" href="#weightit-050"></a></h2><p class="text-muted">CRAN release: 2018-11-22</p>
<ul><li><p>Added <code>super</code> method to estimate propensity scores using the <code>SuperLearner</code> package.</p></li>
<li><p>Added <code>optweight</code> method to estimate weights using optimization (but you should probably just use the <code>optweight</code> package).</p></li>
<li><p><code><a href="../reference/weightit.html">weightit()</a></code> now uses the correct formula to estimate weights for the ATO with multinomial treatments as described by Li &amp; Li (2018).</p></li>
<li><p>Added <code>include.obj</code> option in <code><a href="../reference/weightit.html">weightit()</a></code> and <code><a href="../reference/weightitMSM.html">weightitMSM()</a></code> to include the fitted object in the output object for inspection. For example, with <code>method = "ps"</code>, the <code>glm</code> object containing the propensity score model will be included in the output.</p></li>
<li><p>Rearranged the help pages. Each method now has its own documentation page, linked from the <code>weightit</code> help page.</p></li>
<li><p>Propensity scores are now included in the output for binary treatments with <code>gbm</code> and <code>cbps</code> methods. Thanks to <a href="https://github.com/Blanch-Font" class="external-link">@Blanch-Font</a> for the suggestion.</p></li>
<li><p>Other bug fixes and minor changes.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.4.0" id="weightit-040">WeightIt 0.4.0<a class="anchor" aria-label="anchor" href="#weightit-040"></a></h2><p class="text-muted">CRAN release: 2018-06-25</p>
<ul><li><p>Added <code><a href="../reference/trim.html">trim()</a></code> function to trim weights.</p></li>
<li><p>Added <code>ps.cont()</code> function, which estimates generalized propensity score weights for continuous treatments using generalized boosted modeling, as in <code>twang</code>. This function uses the same syntax as <code>ps()</code> in <code>twang</code>, and can also be accessed using <code><a href="../reference/weightit.html">weightit()</a></code> with <code>method = "gbm"</code>. Support functions were added to make it compatible with <code>twang</code> functions for assessing balance (e.g., <code>summary</code>, <code>bal.table</code>, <code>plot</code>). Thanks to Donna Coffman for enlightening me about this method and providing the code to implement it.</p></li>
<li><p>The input formula is now much more forgiving, allowing objects in the environment to be included. The <code>data</code> argument to <code><a href="../reference/weightit.html">weightit()</a></code> is now optional. To simplify things, the output object no longer contains a <code>data</code> field.</p></li>
<li><p>Under-the-hood changes to facilitate adding new features and debugging. Some aspects of the output objects have been slightly changed, but it shouldn’t affect use for most users.</p></li>
<li><p>Fixed a bug where variables would be thrown out when <code>method = "ebal"</code>.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.2" id="weightit-032">WeightIt 0.3.2<a class="anchor" aria-label="anchor" href="#weightit-032"></a></h2><p class="text-muted">CRAN release: 2018-03-14</p>
<ul><li><p>Added new <code>moments</code> and <code>int</code> options for some <code><a href="../reference/weightit.html">weightit()</a></code> methods to easily specify moments and interactions of covariates.</p></li>
<li><p>Fixed bug when using objects not in the data set in <code><a href="../reference/weightit.html">weightit()</a></code>. Behavior has changed to include transformed covariates entered in formula in <code><a href="../reference/weightit.html">weightit()</a></code> output.</p></li>
<li><p>Fixed bug resulting from potentially colinearity when using <code>ebal</code> or <code>ebcw</code>.</p></li>
<li><p>Added a vignette.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.1" id="weightit-031">WeightIt 0.3.1<a class="anchor" aria-label="anchor" href="#weightit-031"></a></h2><p class="text-muted">CRAN release: 2018-03-03</p>
<ul><li><p>Edits to code and help files to protect against missing <code>CBPS</code> package.</p></li>
<li><p>Corrected sampling weights functionality so they work correctly. Also expanded sampling weights to be able to be used with all methods, including those that do not natively allow for sampling weights (e.g., <code>ATE</code>).</p></li>
<li><p>Minor bug fixes and spelling corrections.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.0" id="weightit-030">WeightIt 0.3.0<a class="anchor" aria-label="anchor" href="#weightit-030"></a></h2><p class="text-muted">CRAN release: 2018-01-14</p>
<ul><li><p>Added <code><a href="../reference/weightitMSM.html">weightitMSM()</a></code> function (and supporting <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> and <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> functions) to estimate weights for marginal structural models with time-varying treatments and covariates.</p></li>
<li><p>Fixed some bugs, including when using CBPS with continuous treatments, and when using <code>focal</code> incorrectly.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.0" id="weightit-020">WeightIt 0.2.0<a class="anchor" aria-label="anchor" href="#weightit-020"></a></h2><p class="text-muted">CRAN release: 2017-11-12</p>
<ul><li><p>Added <code>method = "sbw"</code> for stable balancing weights (now removed and replaced with <code>method = "optweight"</code>)</p></li>
<li><p>Allowed for estimation of multinomial propensity scores using multiple binary regressions if <code>mlogit</code> is not installed</p></li>
<li><p>Allowed for estimation of multinomial CBPS using multiple binary CBPS for more than 4 groups</p></li>
<li><p>Added README and NEWS</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.0" id="weightit-010">WeightIt 0.1.0<a class="anchor" aria-label="anchor" href="#weightit-010"></a></h2><p class="text-muted">CRAN release: 2017-10-17</p>
<ul><li>First version!</li>
</ul></div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

